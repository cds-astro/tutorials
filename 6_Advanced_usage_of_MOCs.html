
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Advanced usage of MOCs to explore complex regions of interest &#8212; Astronomy with Python: Tutorials</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '6_Advanced_usage_of_MOCs';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="canonical" href="https://cds-astro.github.io/tutorials/intro.html/6_Advanced_usage_of_MOCs.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Multi Order Coverage data structure to plan multi-messenger observations" href="7_Multi-messenger_astronomy__Planning_observations_rapidly_with_MOCs.html" />
    <link rel="prev" title="Discovery of brown dwarfs mining the 2MASS and SDSS databases" href="5_Brown_Dwarf_Search__Cross-matching_Catalogs.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/Tutorials_front_logo.png" class="logo__image only-light" alt="Astronomy with Python: Tutorials - Home"/>
    <img src="_static/Tutorials_front_logo.png" class="logo__image only-dark pst-js-only" alt="Astronomy with Python: Tutorials - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Accessing and using astronomical data from Python: a series of Jupyter notebooks tutorials
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1_Intro_to_CDS_services_in_notebooks.html">Introduction to the CDS services</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_Peculiar_galaxies__first_steps_with_MOCs.html">First steps with Multi-Order Coverage data structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_Cluster_of_Galaxies__the_Simple_Spectral_Access_Protocol.html">The Simple Spectral Access Protocol to explore Abel 1656</a></li>
<li class="toctree-l1"><a class="reference internal" href="4_High_Energy_sources__Multi_instrument_multi_wavelength_exploration_using_VO_tools.html">Combining the CDS services to study gamma-ray and high energy spectral bands</a></li>
<li class="toctree-l1"><a class="reference internal" href="5_Brown_Dwarf_Search__Cross-matching_Catalogs.html">Cross matching catalogs to discover potential brown dwarfs</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Advanced usage of MOCs</a></li>
<li class="toctree-l1"><a class="reference internal" href="7_Multi-messenger_astronomy__Planning_observations_rapidly_with_MOCs.html">Planning multi-messenger observations rapidly with MOCs</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/cds-astro/tutorials/master?urlpath=tree/6_Advanced_usage_of_MOCs.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/cds-astro/tutorials" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/cds-astro/tutorials/issues/new?title=Issue%20on%20page%20%2F6_Advanced_usage_of_MOCs.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/6_Advanced_usage_of_MOCs.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Advanced usage of MOCs to explore complex regions of interest</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-finding-the-images">Step 1: Finding the images</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-create-a-moc-of-the-mash-images">Step 2: Create a MOC of the MASH images</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#organising-data">Organising data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-the-moc">Create the MOC</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-moc">Plot the MOC</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-load-an-archival-extinction-map-and-create-the-moc-of-the-low-extinction-regions">Step 3: Load an archival extinction map and create the MOC of the low extinction regions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-find-out-which-regions-are-covered-by-the-mash-short-red-images-in-the-low-extinction-regions-defined-above">Step 4:  Find out which regions are covered by the MASH short-red images in the low extinction regions defined above</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-query-the-2mass-and-gaia-catalogues-by-moc">Step 5: Query the 2MASS and Gaia Catalogues by MOC</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-6-cross-match-gaia-and-2mass-sources-in-all-fields">Step 6: Cross-match Gaia and 2MASS sources in all fields</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-7-build-a-color-color-diagram">Step 7: Build a color-color diagram</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="advanced-usage-of-mocs-to-explore-complex-regions-of-interest">
<h1>Advanced usage of MOCs to explore complex regions of interest<a class="headerlink" href="#advanced-usage-of-mocs-to-explore-complex-regions-of-interest" title="Link to this heading">#</a></h1>
<p>Stefania Amodea¹, Matthieu Baumann¹, Thomas Boch¹, Caroline Bot¹, Katarina A. Lutz¹.</p>
<ol class="arabic simple">
<li><p>Université de Strasbourg, CNRS, Observatoire Astronomique de Strasbourg, UMR 7550, F-67000, Strasbourg, France</p></li>
</ol>
<p>Thomas Boch and Caroline Bot wrote the original version of this tutorial, available on the <a class="reference external" href="http://www.euro-vo.org/?q=science/scientific-tutorials">EURO-VO tutorials page</a>. It was presented at the workshop “<a class="reference external" href="https://www.lsstcorporation.org/node/107">Detecting the unexpected, Discovery in the Era of Astronomically Big Data</a>”. The version here is an adaptation to jupyter notebooks by the Strasbourg astronomical Data Center (<a class="reference external" href="https://cdsweb.u-strasbg.fr/">CDS</a>) team.</p>
<hr class="docutils" />
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>I have a set of images. I would like to select regions in my observations that are above a given threshold in another survey (e.g. at low extinction), retrieve objects from very large catalogs (e.g. Gaia + 2MASS) in these non-trivial shapes and not-necessarily-connected regions, and combine them to visualize some quantities (e.g. color color diagram).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Standard Library</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="c1"># Astronomy tools</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">astropy.units</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">u</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.coordinates</span><span class="w"> </span><span class="kn">import</span> <span class="n">Angle</span><span class="p">,</span> <span class="n">SkyCoord</span><span class="p">,</span> <span class="n">match_coordinates_sky</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">fits</span>

<span class="c1"># Access astronomical databases</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvo</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astroquery.vizier</span><span class="w"> </span><span class="kn">import</span> <span class="n">Vizier</span>

<span class="c1"># Moc and HEALPix tools</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cdshealpix</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">mocpy</span>

<span class="c1"># For plots</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Data handling</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-1-finding-the-images">
<h2>Step 1: Finding the images<a class="headerlink" href="#step-1-finding-the-images" title="Link to this heading">#</a></h2>
<p>We want to find all Short-Red images in the Macquarie/AAO/Strasbourg Hα Planetary Galactic catalog (<a class="reference external" href="https://vizier.cfa.harvard.edu/vizier/MASH/index.htx">MASH</a>) using the VizieR associated data service.</p>
<p><a class="reference external" href="https://vizier.cds.unistra.fr/viz-bin/VizieR" title="https://vizier.cds.unistra.fr/viz-bin/VizieR"><img alt="Vizier" src="https://custom-icon-badges.demolab.com/badge/Vizier-gray.svg?logo=vizier&amp;logoColor=orange&amp;logoWidth=20" /></a></p>
<p>The <a class="reference external" href="https://vizier.cds.unistra.fr/">VizieR</a> service at CDS inventories astronomical catalogs published in the literature. Some of these catalogs contain data associated with publications and the tables therein. This data can be browsed and explored through the VizieR-associated data service, linked to the traditional VizieR table service. Here we look for images associated with the MASH catalog of planetary nebulae (<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2006yCat.5127....0P/abstract">Parker <em>et. al.</em> 2006-2008</a>). The MASH fits files are cut-outs extracted from a larger Hα and Short Red survey to constitute a set of regions of interest around planetary nebulae.</p>
<p>To find VizieR-associated data, we use the Table Access Protocol (TAP) with the VizieR endpoint. Through the VizieR TAP endpoint, we can search for tables, their content, and information on associated data.</p>
<p>First, we search for the MASH catalog:</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># give the address of the service, you can also directly visit the website</span>
<span class="n">tap_vizier</span> <span class="o">=</span> <span class="n">pyvo</span><span class="o">.</span><span class="n">dal</span><span class="o">.</span><span class="n">TAPService</span><span class="p">(</span><span class="s2">&quot;https://tapvizier.cds.unistra.fr/TAPVizieR/tap&quot;</span><span class="p">)</span>

<span class="c1"># a query that searches for all tables with the words MASH and Parker in their description</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT  *  FROM tables </span>
<span class="s2">        WHERE description LIKE &#39;%MASH%Parker%&#39;</span>
<span class="s2">        &quot;&quot;&quot;</span>

<span class="n">mash_catalogues</span> <span class="o">=</span> <span class="n">tap_vizier</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">query</span><span class="p">)</span><span class="o">.</span><span class="n">to_table</span><span class="p">()</span>
<span class="n">mash_catalogues</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table length=5</i>
<table id="table139673813597920" class="table-striped table-bordered table-condensed">
<thead><tr><th>schema_name</th><th>table_name</th><th>table_type</th><th>description</th><th>utype</th><th>nrows</th></tr></thead>
<thead><tr><th>object</th><th>object</th><th>object</th><th>object</th><th>object</th><th>object</th></tr></thead>
<tr><td>J_MNRAS</td><td>J/MNRAS/412/223/table4</td><td>table</td><td>The nine MASH PNe detected and possibly detected in the PMN survey ( Bojicic I.S., Parker Q.A., Filipovic M.D., Frew D.J.)</td><td></td><td>9</td></tr>
<tr><td>J_MNRAS</td><td>J/MNRAS/412/223/table1</td><td>table</td><td>MASH PNe detected in the NVSS ( Bojicic I.S., Parker Q.A., Filipovic M.D., Frew D.J.)</td><td></td><td>201</td></tr>
<tr><td>V_combined</td><td>V/127A/mash2</td><td>table</td><td>The MASH-II Supplement (from paper II) ( Parker Q.A., Acker A., Frew D.J., Hartley M., Peyaud A.E.J., Phillipps S., Russeil D., Beaulieu S.F., Cohen M., Koppen J., Marcout J., Miszalski B., Morgan D.H., Morris R.A.H., Ochsenbein F., Pierce M.J.,)</td><td></td><td>335</td></tr>
<tr><td>V_combined</td><td>V/127A/mash1</td><td>table</td><td>The MASH Catalog of Planetary Nebulae (paper I) ( Parker Q.A., Acker A., Frew D.J., Hartley M., Peyaud A.E.J., Phillipps S., Russeil D., Beaulieu S.F., Cohen M., Koppen J., Marcout J., Miszalski B., Morgan D.H., Morris R.A.H., Ochsenbein F., Pierce M.J.,)</td><td></td><td>903</td></tr>
<tr><td>J_MNRAS</td><td>J/MNRAS/412/223/mpgs2</td><td>table</td><td>MASH PNe detected in the MPGS-2 (Cat. VIII/82) ( Bojicic I.S., Parker Q.A., Filipovic M.D., Frew D.J.)</td><td></td><td>81</td></tr>
</table></div></div></div>
</div>
<p>In this tutorial, we are interested in the tables belonging to the catalogs <code class="docutils literal notranslate"><span class="pre">V/127A</span></code>. This includes tables <code class="docutils literal notranslate"><span class="pre">V/127A/mash1</span></code> and <code class="docutils literal notranslate"><span class="pre">V/127A/mash2</span></code>. To have a look at the content of these tables, we look at their first lines like this:</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT TOP 5 * FROM </span><span class="se">\&quot;</span><span class="s2">V/127A/mash1</span><span class="se">\&quot;</span><span class="s2"> </span>
<span class="s2">        &quot;&quot;&quot;</span>
<span class="n">mash1_head</span> <span class="o">=</span> <span class="n">tap_vizier</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">query</span><span class="p">)</span><span class="o">.</span><span class="n">to_table</span><span class="p">()</span>
<span class="n">mash1_head</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table length=5</i>
<table id="table139673813289808" class="table-striped table-bordered table-condensed">
<thead><tr><th>recno</th><th>n_PNG</th><th>PNG</th><th>Name</th><th>RAJ2000</th><th>DEJ2000</th><th>GLon</th><th>GLat</th><th>MajDiam</th><th>MinDiam</th><th>CS</th><th>Morph</th><th>Tel</th><th>ObsDate</th><th>HaExp</th><th>HaFld</th><th>Comments</th><th>img</th><th>ImageHa</th><th>ImageSr</th><th>AssocData</th></tr></thead>
<thead><tr><th></th><th></th><th></th><th></th><th>deg</th><th>deg</th><th>deg</th><th>deg</th><th>arcsec</th><th>arcsec</th><th></th><th></th><th></th><th>&apos;Y:M:D&apos;</th><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead>
<thead><tr><th>int32</th><th>str1</th><th>object</th><th>object</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>object</th><th>object</th><th>object</th><th>float64</th><th>object</th><th>object</th><th>object</th><th>object</th><th>object</th><th>object</th><th>object</th></tr></thead>
<tr><td>29</td><td>L</td><td>G234.7-02.2</td><td>PHR0724-2021</td><td>111.05458333333331</td><td>-20.36361111111111</td><td>234.7045</td><td>-2.2774</td><td>134.5</td><td>54.0</td><td></td><td>A</td><td>SA</td><td>2452672.0</td><td>HA18201</td><td>HA842</td><td>Large, very faint diffuse arcuate nebula; has [NII]~2xH-alpha, nothing in blue</td><td>1029</td><td>img_ha</td><td>img_sr</td><td>fits</td></tr>
<tr><td>2</td><td>P</td><td>G227.3-12.0</td><td>PHR0633-1808</td><td>98.35374999999999</td><td>-18.13972222222222</td><td>227.3207</td><td>-12.0289</td><td>17.0</td><td>15.0</td><td></td><td>Ea</td><td>SA</td><td>2452672.0</td><td>HA18191</td><td>HA926</td><td>Very faint, partial arcuate nebula also observed M1 060100; [NII]~0.8xH-alpha, strong [SII], only weak H-beta in blue - inconclusive</td><td>1002</td><td>img_ha</td><td>img_sr</td><td>fits</td></tr>
<tr><td>16</td><td>T</td><td>G227.2-03.4</td><td>PHR0705-1419</td><td>106.41041666666665</td><td>-14.318055555555553</td><td>227.2852</td><td>-3.4029</td><td>15.0</td><td>15.0</td><td></td><td>E</td><td>SA</td><td>2452668.0</td><td>HA18244</td><td>HA1017</td><td>Small, circular PN around a faint central star; also observed M1 040100; [NII]~0.7 H-alpha, [OIII]&gt;&gt;H-beta</td><td>1016</td><td>img_ha</td><td>img_sr</td><td>fits</td></tr>
<tr><td>5</td><td>L</td><td>G223.6-06.8</td><td>PHR0646-1235</td><td>101.60583333333332</td><td>-12.598888888888887</td><td>223.6338</td><td>-6.8035</td><td>40.0</td><td>37.0</td><td></td><td>E</td><td>SA</td><td>2453788.0</td><td>HA18194</td><td>HA1016</td><td>Slightly oval very faint PN candidate - has [OIII] and H-alpha</td><td>1005</td><td>img_ha</td><td>img_sr</td><td>fits</td></tr>
<tr><td>10</td><td>P</td><td>G224.3-05.5</td><td>PHR0652-1240</td><td>103.08458333333331</td><td>-12.67611111111111</td><td>224.3504</td><td>-5.5463</td><td>187.0</td><td>180.0</td><td></td><td>I</td><td>SA</td><td>2452670.0</td><td>HA18244</td><td>HA1017</td><td>Faint, extended S-shaped emission nebula, possible evolved PN, also observed M1 080100; has [NII]~0.8Ha, [OIII], strong [SII], [OIII]&gt;H-beta</td><td>1010</td><td>img_ha</td><td>img_sr</td><td>fits</td></tr>
</table></div></div></div>
</div>
<p>As you can see, the last column of this table is called <code class="docutils literal notranslate"><span class="pre">AssocData</span></code> and contains the entry <code class="docutils literal notranslate"><span class="pre">fits</span></code>. If you look at this table on the VizieR web interface, you can download the associated fits file. Within this notebook, we query the <code class="docutils literal notranslate"><span class="pre">obscore</span></code> database to get the URLs to the fits file. Using the <code class="docutils literal notranslate"><span class="pre">astropy.io.fits</span></code> module, we can open the fits files from their URLs.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obs_tap_vizier</span> <span class="o">=</span> <span class="n">pyvo</span><span class="o">.</span><span class="n">dal</span><span class="o">.</span><span class="n">TAPService</span><span class="p">(</span>
    <span class="s2">&quot;https://cdsarc.cds.unistra.fr/saadavizier.tap/tap&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT TOP 5  *  FROM obscore </span>
<span class="s2">        WHERE obs_collection=&#39;V/127A&#39;   </span>
<span class="s2">        &quot;&quot;&quot;</span>
<span class="n">mash_fits</span> <span class="o">=</span> <span class="n">obs_tap_vizier</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">query</span><span class="p">)</span><span class="o">.</span><span class="n">to_table</span><span class="p">()</span>
<span class="n">mash_fits</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table length=5</i>
<table id="table139673813596624" class="table-striped table-bordered table-condensed">
<thead><tr><th>access_estsize</th><th>access_format</th><th>access_url</th><th>bib_reference</th><th>calib_level</th><th>dataproduct_type</th><th>em_band</th><th>em_max</th><th>em_min</th><th>extension</th><th>facility_name</th><th>has_wcs</th><th>instrument_name</th><th>obs_collection</th><th>obs_id</th><th>obs_publisher_did</th><th>oidsaada</th><th>o_ucd</th><th>pol_states</th><th>s_dec</th><th>s_fov</th><th>s_ra</th><th>s_region</th><th>s_resolution</th><th>target_name</th><th>t_exptime</th><th>t_max</th><th>t_min</th><th>t_resolution</th></tr></thead>
<thead><tr><th>kbyte</th><th></th><th></th><th></th><th></th><th></th><th>spect</th><th></th><th></th><th>meta.code</th><th></th><th>meta.code</th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th>deg</th><th>deg</th><th>deg</th><th></th><th>arcsec</th><th></th><th></th><th></th><th></th><th></th></tr></thead>
<thead><tr><th>int64</th><th>object</th><th>object</th><th>object</th><th>int32</th><th>object</th><th>object</th><th>float64</th><th>float64</th><th>int32</th><th>object</th><th>int32</th><th>object</th><th>object</th><th>object</th><th>object</th><th>object</th><th>object</th><th>object</th><th>float64</th><th>float64</th><th>float64</th><th>object</th><th>float64</th><th>object</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>
<tr><td>610</td><td>application/fits</td><td>https://cdsarc.cds.unistra.fr/saadavizier/download?oid=864975549779410945</td><td>2006MNRAS.373...79P</td><td>-1</td><td>image</td><td>Optical</td><td>1e-06</td><td>3e-07</td><td>--</td><td>UKST</td><td>5</td><td>SuperCOSMOS I</td><td>V/127A</td><td>1032_sr.fits</td><td>ivo://CDS.VizieR/V/127A?res=1032_sr.fits</td><td>864975549779410945</td><td>obs.image</td><td>NotSet</td><td>-13.784389854801203</td><td>0.0713021682865721</td><td>111.43275777455307</td><td>Polygon ICRS  111.46664940645094 -13.81781914701963  111.39832407190251 -13.817324215795937  111.3988758446347 -13.750955924906409  111.46718176614709 -13.751450706358609</td><td>0.948991575097523</td><td></td><td>--</td><td>--</td><td>51226.0</td><td>--</td></tr>
<tr><td>714</td><td>application/fits</td><td>https://cdsarc.cds.unistra.fr/saadavizier/download?oid=864975549779410946</td><td>2006MNRAS.373...79P</td><td>-1</td><td>image</td><td>Optical</td><td>1e-06</td><td>3e-07</td><td>--</td><td>UKST</td><td>5</td><td>SuperCOSMOS I</td><td>V/127A</td><td>1002_ha.fits</td><td>ivo://CDS.VizieR/V/127A?res=1002_ha.fits</td><td>864975549779410946</td><td>obs.image</td><td>NotSet</td><td>-18.139618250252592</td><td>0.06807629850604295</td><td>98.3536194209876</td><td>Polygon ICRS  98.3879823237976 -18.17328539691655  98.31817068063498 -18.172295336426327  98.31926974725019 -18.105945008699248  98.38905491554986 -18.106934677663524</td><td>0.9487309062128839</td><td></td><td>--</td><td>--</td><td>51158.0</td><td>--</td></tr>
<tr><td>754</td><td>application/fits</td><td>https://cdsarc.cds.unistra.fr/saadavizier/download?oid=864975549779410947</td><td>2006MNRAS.373...79P</td><td>-1</td><td>image</td><td>Optical</td><td>1e-06</td><td>3e-07</td><td>--</td><td>UKST</td><td>5</td><td>SuperCOSMOS I</td><td>V/127A</td><td>1033_ha.fits</td><td>ivo://CDS.VizieR/V/127A?res=1033_ha.fits</td><td>864975549779410947</td><td>obs.image</td><td>NotSet</td><td>-28.97290230510999</td><td>0.07273587908530431</td><td>111.5198237403422</td><td>Polygon ICRS  111.55713579830989 -29.006593110324985  111.48129478490598 -29.005543503560524  111.48253597444139 -28.939201209841514  111.5583283925454 -28.94025013401036</td><td>0.9486651876518051</td><td></td><td>--</td><td>--</td><td>50867.0</td><td>--</td></tr>
<tr><td>581</td><td>application/fits</td><td>https://cdsarc.cds.unistra.fr/saadavizier/download?oid=864975549779410948</td><td>2006MNRAS.373...79P</td><td>-1</td><td>image</td><td>Optical</td><td>1e-06</td><td>3e-07</td><td>--</td><td>UKST</td><td>5</td><td>SuperCOSMOS I</td><td>V/127A</td><td>1002_sr.fits</td><td>ivo://CDS.VizieR/V/127A?res=1002_sr.fits</td><td>864975549779410948</td><td>obs.image</td><td>NotSet</td><td>-18.13962593857754</td><td>0.06807301936327177</td><td>98.35359006999442</td><td>Polygon ICRS  98.38795041597254 -18.17329148584167  98.31813924430983 -18.172303630142665  98.31924295149577 -18.105954297342016  98.38902764888365 -18.106941759807857</td><td>0.9487205770226425</td><td></td><td>--</td><td>--</td><td>51160.0</td><td>--</td></tr>
<tr><td>607</td><td>application/fits</td><td>https://cdsarc.cds.unistra.fr/saadavizier/download?oid=864975549779410949</td><td>2006MNRAS.373...79P</td><td>-1</td><td>image</td><td>Optical</td><td>1e-06</td><td>3e-07</td><td>--</td><td>UKST</td><td>5</td><td>SuperCOSMOS I</td><td>V/127A</td><td>1033_sr.fits</td><td>ivo://CDS.VizieR/V/127A?res=1033_sr.fits</td><td>864975549779410949</td><td>obs.image</td><td>NotSet</td><td>-28.97292411093542</td><td>0.07273534143391176</td><td>111.51984609001715</td><td>Polygon ICRS  111.55715777828372 -29.00661467563269  111.48131691638382 -29.005565388666998  111.48255869339395 -28.93922325635545  111.55835096020016 -28.940271860424208</td><td>0.9486629846629874</td><td></td><td>--</td><td>--</td><td>50879.0</td><td>--</td></tr>
</table></div></div></div>
</div>
<p>As you can see, the result from this query provides information on the fits files associated with the MASH catalogs. In particular, the column <code class="docutils literal notranslate"><span class="pre">access_url</span></code> provides the location of the data. To get the first image we can do:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># download the first image</span>
<span class="n">hdul_list</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">mash_fits</span><span class="p">[</span><span class="s2">&quot;access_url&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot it in a quick preview</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">hdul_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x7f080586ebb0&gt;
</pre></div>
</div>
<img alt="_images/674842a224432dade51f389ac6e46ca1ed132923b554a87b3c3940135d6be43f.png" src="_images/674842a224432dade51f389ac6e46ca1ed132923b554a87b3c3940135d6be43f.png" />
</div>
</div>
<p>This should be done for every image in the list. However, downloading all the data takes quite some time. For this tutorial, <strong>we prepared a subsample of 335 of these Short Red images that will run promptly</strong> but we encourage you to try accessing the full Short Red sample on your own later. The subsample is available in the Data Folder of this repository.</p>
</section>
<section id="step-2-create-a-moc-of-the-mash-images">
<h2>Step 2: Create a MOC of the MASH images<a class="headerlink" href="#step-2-create-a-moc-of-the-mash-images" title="Link to this heading">#</a></h2>
<p>The multi-order coverage (MOC) map of a set of images represents their sky coverage. MOCs can describe arbitrary zones in the sky which do not need to be connected. You’ll see that the union or intersection of two MOCs requires few time and computational effort. Catalogs can also be filtered by MOCs.</p>
<p>Here we want to use the fits files just downloaded to create a MOC map corresponding to the coverage of the MASH images.</p>
<section id="organising-data">
<h3>Organising data<a class="headerlink" href="#organising-data" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Where to find fits images downloaded from the archive above</span>
<span class="n">datadir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;Data/MASH_Sample/&quot;</span><span class="p">)</span>
<span class="n">datadir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In most cases, we could ignore the next cell.  However, some possible deprecated keywords in the fits header would hamper the MOC creation and would cause errors in the underlying <code class="docutils literal notranslate"><span class="pre">astropy.wcs.WCS</span></code> module. This is why we rewrite the headers of the fits files so that they only contain the useful keywords needed to define the coordinate frame correctly before using <code class="docutils literal notranslate"><span class="pre">mocpy</span></code>.</p>
</section>
<section id="create-the-moc">
<h3>Create the MOC<a class="headerlink" href="#create-the-moc" title="Link to this heading">#</a></h3>
<p>Here we can create the MOC of the MASH images with the <code class="docutils literal notranslate"><span class="pre">MOCPy</span></code> module. This can take a few seconds.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get a list of the fits files and create the MOC</span>
<span class="n">mash_file_list</span> <span class="o">=</span> <span class="n">datadir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span>
    <span class="s2">&quot;*_sr_modified.fits&quot;</span><span class="p">,</span>
<span class="p">)</span>  <span class="c1"># glob allows to find all paths that end with _sr_modified.fits in datadir</span>
<span class="n">mash_file_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> <span class="k">for</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="n">mash_file_list</span><span class="p">]</span>
<span class="n">moc_mash</span> <span class="o">=</span> <span class="n">mocpy</span><span class="o">.</span><span class="n">MOC</span><span class="o">.</span><span class="n">from_fits_images</span><span class="p">(</span><span class="n">mash_file_list</span><span class="p">,</span> <span class="n">max_norder</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="c1"># this takes a bit of time because a lot of files are opened and processed to extract the moc</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING: FITSFixedWarning: RADECSYS= &#39;FK5 &#39; 
the RADECSYS keyword is deprecated, use RADESYSa. [astropy.wcs.wcs]
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-the-moc">
<h3>Plot the MOC<a class="headerlink" href="#plot-the-moc" title="Link to this heading">#</a></h3>
<p>We can chose between two of the MOCpy methods to plot the MOC</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># A one-liner for a very fast visualization</span>
<span class="n">moc_mash</span><span class="o">.</span><span class="n">display_preview</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/201b90bab49527bf3a811bb61790d19585d4c2b316d4eeeec571635f63a7e947.png" src="_images/201b90bab49527bf3a811bb61790d19585d4c2b316d4eeeec571635f63a7e947.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># With a bit more control over the output, the MOC.wcs method</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">wcs</span> <span class="o">=</span> <span class="n">moc_mash</span><span class="o">.</span><span class="n">wcs</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">wcs</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># noqa: FBT003</span>
<span class="n">moc_mash</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">wcs</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;purple&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0bef59ed64f792d91ac409276e6f6a2682ad848ffbfaf3d2b12c08118562413e.png" src="_images/0bef59ed64f792d91ac409276e6f6a2682ad848ffbfaf3d2b12c08118562413e.png" />
</div>
</div>
<p>You can see how the MOC has arbitrary shapes and not all regions are connected.</p>
<p>And for more control over the plot parameters, there is also the mocpy.WCS method (!)</p>
</section>
</section>
<section id="step-3-load-an-archival-extinction-map-and-create-the-moc-of-the-low-extinction-regions">
<h2>Step 3: Load an archival extinction map and create the MOC of the low extinction regions<a class="headerlink" href="#step-3-load-an-archival-extinction-map-and-create-the-moc-of-the-low-extinction-regions" title="Link to this heading">#</a></h2>
<p>Different works (e.g. <a class="reference external" href="https://iopscience.iop.org/article/10.1086/305772">Schlegel et al. 1998</a>, <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2011AAS...21831803S/abstract">Schlafly  &amp; Finkbeiner 2011</a>, <a class="reference external" href="https://iopscience.iop.org/article/10.1088/0004-637X/810/1/25">Green et al. 2015</a>…) have created extinction maps of the sky that are publicly available. Some of these maps are all-sky maps, while others have higher resolutions, or come from different methods… They can be found in HEALPix format (among others) on the Legacy Archive for Microwave Background Data Analysis (<a class="reference external" href="https://lambda.gsfc.nasa.gov/">LAMBDA</a>) website or on the Analysis Center for Extended Data (<a class="reference external" href="http://cade.irap.omp.eu/dokuwiki/doku.php?id=start">CADE</a>) website.</p>
<p>For this tutorial, we will download the well-known all-sky extinction map from Schlegel <em>et al.</em> from the LAMBDA  website and define the low extinction area for which <span class="math notranslate nohighlight">\(0 &lt; E(B-V) &lt; 0.5\)</span> as a MOC. It has an <a class="reference external" href="https://lambda.gsfc.nasa.gov/product/foreground/fg_sfd_info.html">information page</a>.</p>
<p>The map is available here: <a class="reference external" href="https://lambda.gsfc.nasa.gov/data/foregrounds/SFD/lambda_sfd_ebv.fits">https://lambda.gsfc.nasa.gov/data/foregrounds/SFD/lambda_sfd_ebv.fits</a> and we save it to disc.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hdul</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
    <span class="s2">&quot;https://lambda.gsfc.nasa.gov/data/foregrounds/SFD/lambda_sfd_ebv.fits&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We are only interested in regions with low extinction. So we aim to get a MOC of all regions where the extinction values from the Schlegel <em>et al.</em> map are between 0 and 0.5mag. The extinction map we got from the NASA webpage is in the HEALPix format. This is an efficient presentation of all-sky maps. The HEALPix tesselation is also used by MOCs. So to get the MOC from the extinction map, we do the following.</p>
<p>First, we check the coordinate system in the map header. We will need to convert to equatorial coordinates, change the projection of the map, and set the order (<em>i.e.</em> resolution) of the map.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hdr</span> <span class="o">=</span> <span class="n">hdul</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span>
<span class="n">hdr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SIMPLE  =                    T / file does conform to FITS standard             
BITPIX  =                   32 / number of bits per data pixel                  
NAXIS   =                    0 / number of data axes                            
EXTEND  =                    T / FITS dataset may contain extensions            
COMMENT   FITS (Flexible Image Transport System) format is defined in &#39;Astronomy
COMMENT   and Astrophysics&#39;, volume 376, page 359; bibcode: 2001A&amp;A...376..359H 
DATE    = &#39;2003-02-05T00:00:00&#39; /file creation date (YYYY-MM-DDThh:mm:ss UT)    
OBJECT  = &#39;ALL-SKY &#39;           / Portion of sky given                           
COMMENT   This file contains an all-sky Galactic reddening map, E(B-V), based on
COMMENT   the derived reddening maps of Schlegel, Finkbeiner and Davis (1998).  
COMMENT   Software and data files downloaded from their website were used to    
COMMENT   interpolate their high resolution dust maps onto pixel centers        
COMMENT   appropriate for a HEALPix Nside=512 projection in Galactic            
COMMENT   coordinates. This file is distributed and maintained by LAMBDA.       
REFERENC= &#39;Legacy Archive for Microwave Background Data Analysis (LAMBDA)      &#39;
REFERENC= &#39;                http://lambda.gsfc.nasa.gov/                        &#39;
REFERENC= &#39;Maps of Dust Infrared Emission for Use in Estimation of Reddening an&#39;
REFERENC= &#39; Cosmic Microwave Background Radiation Foregrounds&#39;,                &#39;
REFERENC= &#39; Schlegel, Finkbeiner &amp; Davis 1998 ApJ 500, 525                     &#39;
REFERENC= &#39;Berkeley mirror site for SFD98 data: http://astron.berkeley.edu/dust&#39;
REFERENC= &#39;Princeton mirror site for SFD98 data:                               &#39;
REFERENC= &#39;                           http://astro/princeton.edu/~schlegel/dust&#39;
REFERENC= &#39;HEALPix Home Page: http://www.eso.org/science/healpix/              &#39;
RESOLUTN=                    9 / Resolution index                               
SKYCOORD= &#39;Galactic&#39;           / Coordinate system                              
PIXTYPE = &#39;HEALPIX &#39;           / Pixel algorithm                                
ORDERING= &#39;NESTED  &#39;           / Ordering scheme                                
NSIDE   =                  512 / Resolution parameter                           
NPIX    =              3145728 / # of pixels                                    
FIRSTPIX=                    0 / First pixel (0 based)                          
LASTPIX =              3145727 / Last pixel (0 based)                           
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">((</span><span class="n">hdul</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">hdul</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(3145728,)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FITS_rec([( 9.625492, 1.), (46.090515, 1.), ( 8.18071 , 1.), ...,
          (15.149189, 1.), (14.107367, 1.), (15.463686, 1.)],
         dtype=(numpy.record, [(&#39;TEMPERATURE&#39;, &#39;&gt;f4&#39;), (&#39;N_OBS&#39;, &#39;&gt;f4&#39;)]))
</pre></div>
</div>
</div>
</div>
<p>The data field here has a specific shape. It contains tuples for which the first value is the extinction (named ‘TEMPERATURE’) and the second one is the number of observations of the value (you can check that it is <code class="docutils literal notranslate"><span class="pre">1</span></code> everywhere).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">extinction_values</span> <span class="o">=</span> <span class="n">hdul</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;TEMPERATURE&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s extract the information about the number of sides and the order of the healpix map from the header of the fits file</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nside</span> <span class="o">=</span> <span class="n">hdul</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s2">&quot;NSIDE&quot;</span><span class="p">]</span>
<span class="n">norder</span> <span class="o">=</span> <span class="n">hdul</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s2">&quot;RESOLUTN&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>The header allows to see that this map is in galactic coordinates. We will need to convert this into equatorial coordinates to compare with our other maps.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creation of an HEALpix grid at order 9 in nested ordering</span>
<span class="n">healpix_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span> <span class="o">*</span> <span class="mi">4</span><span class="o">**</span><span class="n">norder</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint64</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;We can check the the NPIX value corresponds to the one in the header here: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">healpix_index</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>We can check the the NPIX value corresponds to the one in the header here: 3145728
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the coordinates of the centers of these healpix cells</span>
<span class="n">center_coordinates_in_equatorial</span> <span class="o">=</span> <span class="n">cdshealpix</span><span class="o">.</span><span class="n">healpix_to_skycoord</span><span class="p">(</span>
    <span class="n">healpix_index</span><span class="p">,</span>
    <span class="n">depth</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">center_coordinates_in_equatorial</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;SkyCoord (ICRS): (ra, dec) in deg
    [( 45.        ,  0.0746039 ), ( 45.08789062,  0.14920793),
     ( 44.91210938,  0.14920793), ..., (315.08789062, -0.14920793),
     (314.91210938, -0.14920793), (315.        , -0.0746039 )]&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert this into galactic coordinates</span>
<span class="n">center_coordinates_in_galactic</span> <span class="o">=</span> <span class="n">center_coordinates_in_equatorial</span><span class="o">.</span><span class="n">galactic</span>
<span class="n">center_coordinates_in_galactic</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;SkyCoord (Galactic): (l, b) in deg
    [(176.8796283 , -48.85086427), (176.89078038, -48.7358142 ),
     (176.70525363, -48.86216423), ..., ( 48.82487228, -28.4122831 ),
     ( 48.7216889 , -28.26178141), ( 48.84578935, -28.29847774)]&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the bilinear interpolation we must apply to each healpix cell to get the values in the other coordinate system</span>
<span class="n">healpix</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="n">cdshealpix</span><span class="o">.</span><span class="n">bilinear_interpolation</span><span class="p">(</span>
    <span class="n">center_coordinates_in_galactic</span><span class="o">.</span><span class="n">l</span><span class="p">,</span>
    <span class="n">center_coordinates_in_galactic</span><span class="o">.</span><span class="n">b</span><span class="p">,</span>
    <span class="n">depth</span><span class="o">=</span><span class="n">norder</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply the interpolation</span>
<span class="n">ext_map_equatorial_nested</span> <span class="o">=</span> <span class="p">(</span><span class="n">extinction_values</span><span class="p">[</span><span class="n">healpix</span><span class="o">.</span><span class="n">data</span><span class="p">]</span> <span class="o">*</span> <span class="n">weights</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ext_map_equatorial_nested</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.08981742, 0.0991632 , 0.08249644, ..., 0.08323811, 0.08352184,
       0.0820533 ])
</pre></div>
</div>
</div>
</div>
<p>Next we declare which pixel we want to use, let’s take all pixels with an extinction lower than 0.5:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">low_extinction_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ext_map_equatorial_nested</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;The low extinction criteria keeps </span><span class="si">{</span><span class="nb">round</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">low_extinction_index</span><span class="p">)</span><span class="o">/</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">extinction_values</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">),</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">% of the sky map&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The low extinction criteria keeps 86.74% of the sky map
</pre></div>
</div>
</div>
</div>
<p>And let’s create a MOC from this criteria</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">moc_low_extinction</span> <span class="o">=</span> <span class="n">mocpy</span><span class="o">.</span><span class="n">MOC</span><span class="o">.</span><span class="n">from_healpix_cells</span><span class="p">(</span>
    <span class="n">low_extinction_index</span><span class="p">,</span>
    <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span>
        <span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span>
                <span class="n">low_extinction_index</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">),</span>
        <span class="n">norder</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">norder</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-4-find-out-which-regions-are-covered-by-the-mash-short-red-images-in-the-low-extinction-regions-defined-above">
<h2>Step 4:  Find out which regions are covered by the MASH short-red images in the low extinction regions defined above<a class="headerlink" href="#step-4-find-out-which-regions-are-covered-by-the-mash-short-red-images-in-the-low-extinction-regions-defined-above" title="Link to this heading">#</a></h2>
<p>To find out the sky regions of the MASH sample that are at low extinction, we build the intersection of the two MOCs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">moc_intersection</span> <span class="o">=</span> <span class="n">moc_low_extinction</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">moc_mash</span><span class="p">)</span>
<span class="c1"># Once the intersection is bluit, we can for example print the sky fraction :</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;The intersection of the two MOCs covers </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">moc_intersection</span><span class="o">.</span><span class="n">sky_fraction</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">% of the sky&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The intersection of the two MOCs covers 0.4778% of the sky
</pre></div>
</div>
</div>
</div>
<p>Now we can visualize the coverage of the two MOCs and their intersection. The grey area is where the extinction is low. The blue one is the MASH coverage. The tiny red dots show the MASH coverage in low extinction regions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

<span class="k">with</span> <span class="n">mocpy</span><span class="o">.</span><span class="n">WCS</span><span class="p">(</span>
    <span class="n">fig</span><span class="p">,</span>
    <span class="n">fov</span><span class="o">=</span><span class="mi">140</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span>
    <span class="n">center</span><span class="o">=</span><span class="n">SkyCoord</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;deg&quot;</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s2">&quot;icrs&quot;</span><span class="p">),</span>
    <span class="n">coordsys</span><span class="o">=</span><span class="s2">&quot;icrs&quot;</span><span class="p">,</span>
    <span class="n">rotation</span><span class="o">=</span><span class="n">Angle</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">),</span>
    <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;AIT&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="k">as</span> <span class="n">wcs</span><span class="p">:</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">wcs</span><span class="p">)</span>

    <span class="n">moc_low_extinction</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">wcs</span><span class="o">=</span><span class="n">wcs</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;low extinction&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">moc_mash</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">wcs</span><span class="o">=</span><span class="n">wcs</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;dodgerblue&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;MASH coverage&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">moc_intersection</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">wcs</span><span class="o">=</span><span class="n">wcs</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;crimson&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;MASH in low extinction regions&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="c1"># Sets labels</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;RA&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Dec&quot;</span><span class="p">)</span>
    <span class="c1"># Sets ticks</span>
    <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ax</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">lon</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="s2">&quot;hh:mm:ss&quot;</span><span class="p">)</span>
    <span class="n">lat</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="s2">&quot;dd:mm&quot;</span><span class="p">)</span>
    <span class="n">lon</span><span class="o">.</span><span class="n">set_ticklabel</span><span class="p">(</span><span class="n">exclude_overlapping</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">lat</span><span class="o">.</span><span class="n">set_ticklabel</span><span class="p">(</span><span class="n">exclude_overlapping</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7f08011ea3a0&gt;
</pre></div>
</div>
<img alt="_images/d1402a582c0c12f41b3b261dc75d378540b6804869e2603c655af5eb160f430e.png" src="_images/d1402a582c0c12f41b3b261dc75d378540b6804869e2603c655af5eb160f430e.png" />
</div>
</div>
</section>
<section id="step-5-query-the-2mass-and-gaia-catalogues-by-moc">
<h2>Step 5: Query the 2MASS and Gaia Catalogues by MOC<a class="headerlink" href="#step-5-query-the-2mass-and-gaia-catalogues-by-moc" title="Link to this heading">#</a></h2>
<p>Without the usage of MOC, querying for sources in the low extinction regions covered by the MASH subsample would be tedious or even impossible. Indeed, one would need to load the whole catalog and make selections which would not be possible given the size of some catalogs. Alternatively, one would need to query the catalog field by field, which would take time and several queries. Instead, here we will use the power of MOC files to query large catalogs directly in the covered regions only. We will use coverages of the low extinction and MASH regions to query for sources from the Gaia and 2MASS surveys in these highly non-continuous and non-trivial shape areas.</p>
<p>First, let’s see which Gaia and 2MASS catalogs are available on VizieR. We could, as above, use the TAP endpoint of VizieR. But we show below the <code class="docutils literal notranslate"><span class="pre">Vizier</span></code> module in the <code class="docutils literal notranslate"><span class="pre">astroquery</span></code> package.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">catalog_list_twomass</span> <span class="o">=</span> <span class="n">Vizier</span><span class="o">.</span><span class="n">find_catalogs</span><span class="p">(</span><span class="s2">&quot;Cutri&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">catalog_list_twomass</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="s2">&quot;: &quot;</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>II/126 :  IRAS Serendipitous Survey Catalog (IPAC 1986)
II/241 :  2MASS Catalog Incremental Data Release (IPAC/UMass, 2000)
II/246 :  2MASS All-Sky Catalog of Point Sources (Cutri+ 2003)
II/281 :  2MASS 6X Point Source Working Database / Catalog (Cutri+ 2006)
II/307 :  WISE Preliminary Data Release (Cutri+ 2011)
II/311 :  WISE All-Sky Data Release (Cutri+ 2012)
II/328 :  AllWISE Data Release (Cutri+ 2013)
II/365 :  The CatWISE2020 catalog (updated version 28-Jan-2021) (Marocco+, 2021)
VII/233 :  2MASS All-Sky Extended Source Catalog (XSC) (IPAC/UMass, 2003-2006)
J/ApJ/560/566 :  K-band galaxy luminosity function from 2MASS (Kochanek+, 2001)
J/ApJ/564/421 :  Spectra of T dwarfs. I. (Burgasser+, 2002)
J/ApJ/569/23 :  Optical polarisation of 2MASS QSOs (Smith+, 2002)
J/ApJ/635/214 :  Chandra X-ray sources and NIR identifications (Ebisawa+, 2005)
J/ApJ/713/330 :  Spitzer observations of major-merger galaxies (Xu+, 2010)
J/ApJ/719/550 :  Deep NIR imaging of {rho} Oph cloud core (Marsh+, 2010)
J/ApJ/741/68 :  Main Belt asteroids with WISE/NEOWISE. I. (Masiero+, 2011)
J/ApJ/742/40 :  Jovian Trojans asteroids with WISE/NEOWISE (Grav+, 2011)
J/ApJ/743/156 :  NEOWISE observations of NEOs: preliminary results (Mainzer+, 2011)
J/ApJ/744/197 :  WISE/NEOWISE observations of Hilda asteroids (Grav+, 2012)
J/ApJ/759/L8 :  WISE/NEOWISE observations of main belt asteroids (Masiero+, 2012)
J/ApJ/760/L12 :  WISE/NEOWISE NEOs preliminary thermal fits (Mainzer+, 2012)
J/ApJ/780/92 :  Light curves of the RR Lyr SDSS J015450.17+001500.7 (Szabo+, 2014)
J/ApJ/783/122 :  AllWISE motion survey (Kirkpatrick+, 2014)
J/ApJ/784/110 :  NEOWISE observations of 105 near-Earth objects (Mainzer+, 2014)
J/ApJ/792/30 :  NEOWISE magnitudes for near-Earth objects (Mainzer+, 2014)
J/ApJ/805/90 :  WISE ELIRGs and comparison with QSOs (Tsai+, 2015)
J/ApJ/814/117 :  NEOWISE Reactivation mission: 1st yr data (Nugent+, 2015)
J/ApJ/874/82 :  Follow-up photometry &amp; spectroscopy of PTF14jg (Hillenbrand+, 2019)
J/ApJS/95/1 :  Atlas of Quasar Energy Distributions (Elvis+ 1994)
J/ApJS/172/663 :  Infrared observations of the Pleiades (Stauffer+, 2007)
J/ApJS/175/191 :  Variables from 2MASS calibration fields (Plavchan+, 2008)
J/ApJS/190/100 :  NIR proper motion survey using 2MASS (Kirkpatrick+, 2010)
J/ApJS/199/26 :  The 2MASS Redshift Survey (2MRS) (Huchra+, 2012)
J/ApJS/224/36 :  The AllWISE motion survey (AllWISE2) (Kirkpatrick+, 2016)
J/ApJS/234/23 :  The WISE AGN candidates catalogs (Assef+, 2018)
J/AJ/112/62 :  Quasar absorption-line systems (Tanner+ 1996)
J/AJ/125/2521 :  2MASS6x survey of the Lockman Hole (Beichman+, 2003)
J/AJ/126/63 :  Host galaxies of 2MASS-QSOs with z&lt;=3 (Hutchings+, 2003)
J/AJ/127/646 :  Unbiased census of AGN in 2MASS (Francis+, 2004)
J/AJ/135/2245 :  Absolute spectrum of the Sun and Vega for 0.2-30um (Rieke+, 2008)
J/AJ/144/148 :  Infrared photometry of brown dwarf and Hyper-LIRG (Griffith+, 2012)
J/AJ/152/63 :  NEOWISE reactivation mission: 2nd yr data (Nugent+, 2016)
J/AJ/154/53 :  WISE/NEOWISE observations of comets (Bauer+, 2017)
J/AJ/154/168 :  NEOWISE: thermal model fits for NEOs and MBAs (Masiero+, 2017)
J/AJ/156/60 :  Thermal model fits for short-arc NEOs with NEOWISE (Masiero+, 2018)
J/PASP/113/10 :  Sub-mJy radio sources complete sample (Masci+, 2001)
</pre></div>
</div>
</div>
</div>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">catalog_list_gaia</span> <span class="o">=</span> <span class="n">Vizier</span><span class="o">.</span><span class="n">find_catalogs</span><span class="p">(</span><span class="s2">&quot;Gaia DR2&quot;</span><span class="p">,</span> <span class="n">max_catalogs</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">catalog_list_gaia</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="s2">&quot;: &quot;</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>I/324 :  The Initial Gaia Source List (IGSL) (Smart, 2013)
I/337 :  Gaia DR1 (Gaia Collaboration, 2016)
I/345 :  Gaia DR2 (Gaia Collaboration, 2018)
I/347 :  Distances to 1.33 billion stars in Gaia DR2 (Bailer-Jones+, 2018)
I/350 :  Gaia EDR3 (Gaia Collaboration, 2020)
I/352 :  Distances to 1.47 billion stars in Gaia EDR3 (Bailer-Jones+, 2021)
I/355 :  Gaia DR3 Part 1. Main source (Gaia Collaboration, 2022)
I/356 :  Gaia DR3 Part 2. Extra-galactic (Gaia Collaboration, 2022)
I/357 :  Gaia DR3 Part 3. Non-single stars (Gaia Collaboration, 2022)
I/358 :  Gaia DR3 Part 4. Variability (Gaia Collaboration, 2022)
I/359 :  Gaia DR3 Part 5. Solar System (Gaia Collaboration, 2022)
I/360 :  Gaia DR3 Part 6. Performance verification (Gaia Collaboration, 2022)
I/361 :  Gaia Focused Product Release (Gaia FPR) (Gaia Collaboration, 2023)
IV/36 :  Gaia-IPHAS/KIS Value-Added Catalogues (Scaringi+, 2018)
V/149 :  LAMOST DR2 catalogs (Luo+, 2016)
VI/137 :  GaiaSimu Universe Model Snapshot (Robin+, 2012)
VI/145 :  ASC Gaia Attitude Star Catalog (Smart, 2015)
IX/52 :  XXL Survey. DR2 (Chiappetti+, 2018)
J/A+A/523/A48 :  Gaia photometry (Jordi+, 2010)
J/A+A/634/A133 :  X-Shooter Spectral Library (XSL). DR2 (Gonneau+, 2020)
J/A+A/674/A25 :  Gaia DR3. spurious signals (Holl+, 2023)
</pre></div>
</div>
</div>
</div>
<p>For 2MASS we will want to use <code class="docutils literal notranslate"><span class="pre">II/246</span> <span class="pre">:</span>&#160; <span class="pre">2MASS</span> <span class="pre">All-Sky</span> <span class="pre">Catalog</span> <span class="pre">of</span> <span class="pre">Point</span> <span class="pre">Sources</span> <span class="pre">(Cutri+</span> <span class="pre">2003)</span></code> and for Gaia <code class="docutils literal notranslate"><span class="pre">I/345</span> <span class="pre">:</span>&#160; <span class="pre">Gaia</span> <span class="pre">DR2</span> <span class="pre">(Gaia</span> <span class="pre">Collaboration,</span> <span class="pre">2018)</span></code>. Before we query the full two tables we only look at a few sources for each table to understand which columns are available. The query below will give us 50 sources each – the default for the <code class="docutils literal notranslate"><span class="pre">get_catalogs</span></code> method.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_twomass</span> <span class="o">=</span> <span class="n">Vizier</span><span class="o">.</span><span class="n">get_catalogs</span><span class="p">(</span><span class="s2">&quot;II/246&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">test_twomass</span><span class="p">)</span>
<span class="n">test_twomass</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TableList with 1 tables:
	&#39;0:II/246/out&#39; with 15 column(s) and 50 row(s) 
</pre></div>
</div>
<div class="output text_html"><div><i>Table length=50</i>
<table id="table139672429448880" class="table-striped table-bordered table-condensed">
<thead><tr><th>RAJ2000</th><th>DEJ2000</th><th>2MASS</th><th>Jmag</th><th>e_Jmag</th><th>Hmag</th><th>e_Hmag</th><th>Kmag</th><th>e_Kmag</th><th>Qflg</th><th>Rflg</th><th>Bflg</th><th>Cflg</th><th>Xflg</th><th>Aflg</th></tr></thead>
<thead><tr><th>deg</th><th>deg</th><th></th><th>mag</th><th>mag</th><th>mag</th><th>mag</th><th>mag</th><th>mag</th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead>
<thead><tr><th>float64</th><th>float64</th><th>str17</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>str3</th><th>int16</th><th>int16</th><th>str3</th><th>uint8</th><th>uint8</th></tr></thead>
<tr><td>29.885839</td><td>56.739094</td><td>01593260+5644207</td><td>16.074</td><td>0.111</td><td>15.612</td><td>0.141</td><td>15.603</td><td>0.185</td><td>BBC</td><td>999</td><td>999</td><td>ccc</td><td>0</td><td>0</td></tr>
<tr><td>29.889511</td><td>56.741344</td><td>01593348+5644288</td><td>15.504</td><td>0.059</td><td>14.870</td><td>0.072</td><td>14.846</td><td>0.084</td><td>AAA</td><td>999</td><td>999</td><td>000</td><td>0</td><td>0</td></tr>
<tr><td>29.895820</td><td>56.744549</td><td>01593499+5644403</td><td>17.312</td><td>0.206</td><td>16.163</td><td>0.202</td><td>15.963</td><td>0.235</td><td>DCD</td><td>999</td><td>999</td><td>000</td><td>0</td><td>0</td></tr>
<tr><td>29.888912</td><td>56.748875</td><td>01593333+5644559</td><td>16.748</td><td>0.142</td><td>16.217</td><td>0.205</td><td>16.200</td><td>--</td><td>BDU</td><td>999</td><td>999</td><td>000</td><td>0</td><td>0</td></tr>
<tr><td>29.905339</td><td>56.747322</td><td>01593728+5644503</td><td>14.288</td><td>0.030</td><td>13.960</td><td>0.045</td><td>13.980</td><td>0.042</td><td>AAA</td><td>999</td><td>999</td><td>000</td><td>0</td><td>0</td></tr>
<tr><td>29.903272</td><td>56.754421</td><td>01593678+5645159</td><td>14.886</td><td>0.044</td><td>14.609</td><td>0.058</td><td>14.582</td><td>0.076</td><td>AAA</td><td>999</td><td>999</td><td>000</td><td>0</td><td>0</td></tr>
<tr><td>29.899930</td><td>56.755199</td><td>01593598+5645187</td><td>16.514</td><td>0.136</td><td>15.726</td><td>--</td><td>15.545</td><td>--</td><td>BUU</td><td>999</td><td>999</td><td>c00</td><td>0</td><td>0</td></tr>
<tr><td>29.915697</td><td>56.755924</td><td>01593976+5645213</td><td>16.371</td><td>0.098</td><td>15.491</td><td>0.108</td><td>15.484</td><td>0.154</td><td>ABC</td><td>999</td><td>999</td><td>000</td><td>0</td><td>0</td></tr>
<tr><td>29.902598</td><td>56.757378</td><td>01593662+5645265</td><td>16.066</td><td>0.096</td><td>15.573</td><td>0.131</td><td>15.048</td><td>0.106</td><td>ABB</td><td>999</td><td>999</td><td>000</td><td>0</td><td>0</td></tr>
<tr><td>29.891583</td><td>56.759617</td><td>01593397+5645346</td><td>15.707</td><td>0.054</td><td>15.658</td><td>0.116</td><td>15.225</td><td>0.126</td><td>ABB</td><td>999</td><td>999</td><td>000</td><td>0</td><td>0</td></tr>
<tr><td>29.897577</td><td>56.761745</td><td>01593541+5645422</td><td>16.729</td><td>0.129</td><td>16.915</td><td>--</td><td>16.512</td><td>--</td><td>BUU</td><td>999</td><td>999</td><td>000</td><td>0</td><td>0</td></tr>
<tr><td>29.895653</td><td>56.764652</td><td>01593495+5645527</td><td>15.645</td><td>0.056</td><td>15.219</td><td>0.093</td><td>15.234</td><td>0.126</td><td>AAB</td><td>999</td><td>999</td><td>000</td><td>0</td><td>0</td></tr>
<tr><td>29.875278</td><td>56.751507</td><td>01593006+5645054</td><td>16.741</td><td>0.138</td><td>16.123</td><td>0.203</td><td>16.141</td><td>--</td><td>BCU</td><td>999</td><td>999</td><td>000</td><td>0</td><td>0</td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>29.932745</td><td>56.766003</td><td>01594385+5645576</td><td>14.479</td><td>0.030</td><td>13.907</td><td>0.041</td><td>13.676</td><td>0.040</td><td>AAA</td><td>999</td><td>999</td><td>000</td><td>0</td><td>0</td></tr>
<tr><td>29.928545</td><td>56.768829</td><td>01594285+5646077</td><td>14.804</td><td>0.039</td><td>14.446</td><td>0.050</td><td>14.365</td><td>0.069</td><td>AAA</td><td>999</td><td>999</td><td>000</td><td>0</td><td>0</td></tr>
<tr><td>29.932344</td><td>56.771584</td><td>01594376+5646177</td><td>15.529</td><td>0.065</td><td>15.177</td><td>0.083</td><td>15.128</td><td>0.125</td><td>AAB</td><td>999</td><td>999</td><td>000</td><td>0</td><td>0</td></tr>
<tr><td>29.931232</td><td>56.770348</td><td>01594349+5646132</td><td>16.874</td><td>0.147</td><td>16.280</td><td>0.223</td><td>15.814</td><td>0.203</td><td>BDD</td><td>999</td><td>999</td><td>cc0</td><td>0</td><td>0</td></tr>
<tr><td>29.941658</td><td>56.772991</td><td>01594599+5646227</td><td>13.444</td><td>0.027</td><td>12.788</td><td>0.034</td><td>12.698</td><td>0.022</td><td>AAA</td><td>999</td><td>999</td><td>000</td><td>0</td><td>0</td></tr>
<tr><td>29.975617</td><td>56.764015</td><td>01595414+5645504</td><td>15.050</td><td>0.046</td><td>14.759</td><td>0.055</td><td>14.512</td><td>0.068</td><td>AAA</td><td>999</td><td>999</td><td>0c0</td><td>0</td><td>0</td></tr>
<tr><td>29.977029</td><td>56.765244</td><td>01595448+5645548</td><td>16.570</td><td>0.128</td><td>16.113</td><td>0.196</td><td>15.698</td><td>--</td><td>BCU</td><td>999</td><td>999</td><td>cc0</td><td>0</td><td>0</td></tr>
<tr><td>29.976605</td><td>56.767006</td><td>01595438+5646012</td><td>16.721</td><td>0.151</td><td>16.118</td><td>0.214</td><td>15.654</td><td>0.199</td><td>BCC</td><td>999</td><td>999</td><td>0c0</td><td>0</td><td>0</td></tr>
<tr><td>29.965056</td><td>56.771534</td><td>01595161+5646175</td><td>15.803</td><td>0.060</td><td>15.462</td><td>0.098</td><td>14.942</td><td>0.104</td><td>AAA</td><td>999</td><td>999</td><td>000</td><td>0</td><td>0</td></tr>
<tr><td>29.977475</td><td>56.775036</td><td>01595459+5646301</td><td>16.744</td><td>0.136</td><td>16.131</td><td>--</td><td>15.563</td><td>--</td><td>BUU</td><td>999</td><td>999</td><td>000</td><td>0</td><td>0</td></tr>
<tr><td>29.982245</td><td>56.774803</td><td>01595573+5646292</td><td>16.129</td><td>0.092</td><td>15.912</td><td>0.159</td><td>15.960</td><td>0.244</td><td>ACD</td><td>999</td><td>999</td><td>000</td><td>0</td><td>0</td></tr>
<tr><td>29.984032</td><td>56.776730</td><td>01595616+5646362</td><td>16.772</td><td>0.120</td><td>16.815</td><td>--</td><td>15.967</td><td>0.249</td><td>BUD</td><td>999</td><td>999</td><td>000</td><td>0</td><td>0</td></tr>
<tr><td>29.970564</td><td>56.781158</td><td>01595293+5646521</td><td>15.914</td><td>0.081</td><td>15.384</td><td>0.095</td><td>15.643</td><td>0.188</td><td>AAC</td><td>999</td><td>999</td><td>000</td><td>0</td><td>0</td></tr>
</table></div></div></div>
</div>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_gaia</span> <span class="o">=</span> <span class="n">Vizier</span><span class="o">.</span><span class="n">get_catalogs</span><span class="p">(</span><span class="s2">&quot;I/345&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">test_gaia</span><span class="p">)</span>
<span class="n">test_gaia</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TableList with 20 tables:
	&#39;0:I/345/gaia2&#39; with 32 column(s) and 50 row(s) 
	&#39;1:I/345/rvstdcat&#39; with 30 column(s) and 50 row(s) 
	&#39;2:I/345/rvstdmes&#39; with 7 column(s) and 50 row(s) 
	&#39;3:I/345/allwise&#39; with 2 column(s) and 50 row(s) 
	&#39;4:I/345/iers&#39; with 2 column(s) and 50 row(s) 
	&#39;5:I/345/cepheid&#39; with 23 column(s) and 50 row(s) 
	&#39;6:I/345/rrlyrae&#39; with 21 column(s) and 50 row(s) 
	&#39;7:I/345/lpv&#39; with 11 column(s) and 50 row(s) 
	&#39;8:I/345/varres&#39; with 7 column(s) and 50 row(s) 
	&#39;9:I/345/shortts&#39; with 9 column(s) and 50 row(s) 
	&#39;10:I/345/tsstat&#39; with 13 column(s) and 50 row(s) 
	&#39;11:I/345/numtrans&#39; with 4 column(s) and 50 row(s) 
	&#39;12:I/345/transits&#39; with 20 column(s) and 50 row(s) 
	&#39;13:I/345/rm&#39; with 9 column(s) and 50 row(s) 
	&#39;14:I/345/rmseg&#39; with 16 column(s) and 50 row(s) 
	&#39;15:I/345/rmout&#39; with 2 column(s) and 50 row(s) 
	&#39;16:I/345/ssoobj&#39; with 6 column(s) and 50 row(s) 
	&#39;17:I/345/ssoorb&#39; with 19 column(s) and 50 row(s) 
	&#39;18:I/345/ssores&#39; with 10 column(s) and 50 row(s) 
	&#39;19:I/345/ssoobs&#39; with 7 column(s) and 50 row(s) 
</pre></div>
</div>
<div class="output text_html"><div><i>Table length=50</i>
<table id="table139672358261904" class="table-striped table-bordered table-condensed">
<thead><tr><th>RA_ICRS</th><th>e_RA_ICRS</th><th>DE_ICRS</th><th>e_DE_ICRS</th><th>Source</th><th>Plx</th><th>e_Plx</th><th>pmRA</th><th>e_pmRA</th><th>pmDE</th><th>e_pmDE</th><th>Dup</th><th>FG</th><th>e_FG</th><th>Gmag</th><th>e_Gmag</th><th>FBP</th><th>e_FBP</th><th>BPmag</th><th>e_BPmag</th><th>FRP</th><th>e_FRP</th><th>RPmag</th><th>e_RPmag</th><th>BP-RP</th><th>RV</th><th>e_RV</th><th>Teff</th><th>AG</th><th>E(BP-RP)</th><th>Rad</th><th>Lum</th></tr></thead>
<thead><tr><th>deg</th><th>mas</th><th>deg</th><th>mas</th><th></th><th>mas</th><th>mas</th><th>mas / yr</th><th>mas / yr</th><th>mas / yr</th><th>mas / yr</th><th></th><th></th><th></th><th>mag</th><th>mag</th><th></th><th></th><th>mag</th><th>mag</th><th></th><th></th><th>mag</th><th>mag</th><th>mag</th><th>km / s</th><th>km / s</th><th>K</th><th>mag</th><th>mag</th><th>solRad</th><th>solLum</th></tr></thead>
<thead><tr><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>int64</th><th>float64</th><th>float32</th><th>float64</th><th>float32</th><th>float64</th><th>float32</th><th>uint8</th><th>float32</th><th>float32</th><th>float64</th><th>float64</th><th>float32</th><th>float32</th><th>float64</th><th>float64</th><th>float32</th><th>float32</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float32</th><th>float64</th><th>float32</th><th>float32</th><th>float32</th><th>float64</th></tr></thead>
<tr><td>44.99615368416</td><td>0.1194</td><td>0.00561580621</td><td>0.1229</td><td>4295806720</td><td>0.0714</td><td>0.1625</td><td>11.733</td><td>0.243</td><td>-4.776</td><td>0.239</td><td>0</td><td>1636</td><td>2.776</td><td>17.6539</td><td>0.0018</td><td>785.6</td><td>8.305</td><td>18.1133</td><td>0.0115</td><td>1205</td><td>12.7</td><td>17.0591</td><td>0.0114</td><td>1.0542</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>45.00497424498</td><td>0.0297</td><td>0.01987700037</td><td>0.0399</td><td>38655544960</td><td>3.1213</td><td>0.0467</td><td>29.670</td><td>0.071</td><td>19.226</td><td>0.083</td><td>0</td><td>4.16e+04</td><td>18.39</td><td>14.1405</td><td>0.0005</td><td>1.769e+04</td><td>53.96</td><td>14.7319</td><td>0.0033</td><td>3.435e+04</td><td>58.43</td><td>13.4220</td><td>0.0018</td><td>1.3099</td><td>--</td><td>--</td><td>4962.00</td><td>0.0320</td><td>0.0160</td><td>0.59</td><td>0.188</td></tr>
<tr><td>45.00431616421</td><td>0.1322</td><td>0.02104503269</td><td>0.1503</td><td>34361129088</td><td>3.4868</td><td>0.1944</td><td>30.300</td><td>0.289</td><td>20.102</td><td>0.290</td><td>0</td><td>1713</td><td>3.034</td><td>17.6040</td><td>0.0019</td><td>397.3</td><td>13.37</td><td>18.8535</td><td>0.0365</td><td>2156</td><td>8.253</td><td>16.4281</td><td>0.0042</td><td>2.4254</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>44.99503703933</td><td>0.3748</td><td>0.03815183599</td><td>0.3546</td><td>309238066432</td><td>1.5788</td><td>0.4509</td><td>0.919</td><td>0.807</td><td>-0.469</td><td>0.720</td><td>0</td><td>263.3</td><td>1.644</td><td>19.6371</td><td>0.0068</td><td>50.62</td><td>4.981</td><td>21.0905</td><td>0.1068</td><td>355.4</td><td>7.532</td><td>18.3851</td><td>0.0230</td><td>2.7054</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>44.96389532530</td><td>0.1673</td><td>0.04359518482</td><td>0.1584</td><td>343597448960</td><td>0.1124</td><td>0.1968</td><td>6.779</td><td>0.340</td><td>-1.592</td><td>0.314</td><td>0</td><td>1037</td><td>2.295</td><td>18.1485</td><td>0.0024</td><td>446.1</td><td>12.47</td><td>18.7278</td><td>0.0304</td><td>851.5</td><td>10.58</td><td>17.4364</td><td>0.0135</td><td>1.2913</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>44.99832632512</td><td>0.4720</td><td>0.06633376572</td><td>0.6080</td><td>515396233856</td><td>-0.3200</td><td>0.5187</td><td>3.500</td><td>0.944</td><td>-8.082</td><td>1.108</td><td>0</td><td>307</td><td>2.209</td><td>19.4704</td><td>0.0078</td><td>148.9</td><td>8.547</td><td>19.9189</td><td>0.0623</td><td>240.7</td><td>10.61</td><td>18.8082</td><td>0.0478</td><td>1.1107</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>45.04828219159</td><td>0.0358</td><td>0.04825622322</td><td>0.0338</td><td>549755818112</td><td>1.5757</td><td>0.0454</td><td>0.777</td><td>0.072</td><td>-16.297</td><td>0.068</td><td>0</td><td>1.879e+04</td><td>12.74</td><td>15.0038</td><td>0.0007</td><td>8207</td><td>27.1</td><td>15.5659</td><td>0.0036</td><td>1.536e+04</td><td>24.3</td><td>14.2959</td><td>0.0017</td><td>1.2701</td><td>--</td><td>--</td><td>4907.03</td><td>--</td><td>--</td><td>0.80</td><td>0.337</td></tr>
<tr><td>45.02361786160</td><td>0.0980</td><td>0.06842024222</td><td>0.1204</td><td>828929527040</td><td>1.1501</td><td>0.1420</td><td>13.600</td><td>0.230</td><td>-10.492</td><td>0.247</td><td>0</td><td>4330</td><td>3.912</td><td>16.5971</td><td>0.0010</td><td>1686</td><td>15.26</td><td>17.2845</td><td>0.0098</td><td>3827</td><td>10.63</td><td>15.8047</td><td>0.0030</td><td>1.4797</td><td>--</td><td>--</td><td>4417.33</td><td>0.3050</td><td>0.1465</td><td>0.71</td><td>0.172</td></tr>
<tr><td>45.02672638278</td><td>0.4853</td><td>0.08169949145</td><td>0.8055</td><td>927713095040</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>0</td><td>326.2</td><td>1.929</td><td>19.4046</td><td>0.0064</td><td>108.7</td><td>13.28</td><td>20.2608</td><td>0.1327</td><td>362.7</td><td>12.86</td><td>18.3631</td><td>0.0385</td><td>1.8977</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>45.03908018543</td><td>0.5170</td><td>0.08685440090</td><td>0.5180</td><td>966367933184</td><td>1.6408</td><td>0.6396</td><td>2.294</td><td>1.163</td><td>2.986</td><td>1.066</td><td>0</td><td>187.6</td><td>1.382</td><td>20.0051</td><td>0.0080</td><td>35.51</td><td>23.37</td><td>21.4754</td><td>0.7144</td><td>243.9</td><td>11.85</td><td>18.7941</td><td>0.0528</td><td>2.6813</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>44.96654570459</td><td>0.3000</td><td>0.04630936452</td><td>0.2850</td><td>1099511693312</td><td>-0.6261</td><td>0.3557</td><td>2.286</td><td>0.636</td><td>-6.278</td><td>0.580</td><td>0</td><td>360</td><td>1.606</td><td>19.2976</td><td>0.0048</td><td>151.1</td><td>7.708</td><td>19.9030</td><td>0.0554</td><td>312.8</td><td>11.15</td><td>18.5239</td><td>0.0387</td><td>1.3792</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>44.99327098082</td><td>0.0612</td><td>0.07633493647</td><td>0.0533</td><td>1275606125952</td><td>0.6361</td><td>0.0702</td><td>-1.346</td><td>0.121</td><td>-6.630</td><td>0.115</td><td>0</td><td>5980</td><td>5.516</td><td>16.2466</td><td>0.0010</td><td>2895</td><td>16.78</td><td>16.6971</td><td>0.0063</td><td>4433</td><td>22.7</td><td>15.6451</td><td>0.0056</td><td>1.0520</td><td>--</td><td>--</td><td>5171.67</td><td>0.3005</td><td>0.1340</td><td>0.98</td><td>0.624</td></tr>
<tr><td>44.96907637680</td><td>0.1227</td><td>0.08442555408</td><td>0.1072</td><td>1340029955712</td><td>0.4029</td><td>0.1395</td><td>2.063</td><td>0.249</td><td>-2.399</td><td>0.224</td><td>0</td><td>1435</td><td>2.324</td><td>17.7962</td><td>0.0018</td><td>613.7</td><td>11.39</td><td>18.3815</td><td>0.0201</td><td>1198</td><td>16.88</td><td>17.0659</td><td>0.0153</td><td>1.3156</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>45.14638432526</td><td>0.1673</td><td>0.16035546034</td><td>0.1422</td><td>2989297243776</td><td>2.1327</td><td>0.2238</td><td>13.874</td><td>0.290</td><td>-14.645</td><td>0.250</td><td>0</td><td>1299</td><td>2.673</td><td>17.9044</td><td>0.0022</td><td>295.1</td><td>10.23</td><td>19.1763</td><td>0.0376</td><td>1521</td><td>16.59</td><td>16.8068</td><td>0.0118</td><td>2.3695</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>45.11664867702</td><td>0.0461</td><td>0.14471993388</td><td>0.0392</td><td>3062312520192</td><td>0.5784</td><td>0.0598</td><td>16.927</td><td>0.083</td><td>3.795</td><td>0.076</td><td>0</td><td>1.578e+04</td><td>8.777</td><td>15.1932</td><td>0.0006</td><td>8268</td><td>38.4</td><td>15.5579</td><td>0.0050</td><td>1.107e+04</td><td>12.27</td><td>14.6518</td><td>0.0012</td><td>0.9061</td><td>--</td><td>--</td><td>5624.52</td><td>0.7028</td><td>0.3163</td><td>1.45</td><td>1.883</td></tr>
<tr><td>45.12994872613</td><td>0.9259</td><td>0.14781648186</td><td>0.7770</td><td>3058016772224</td><td>4.9369</td><td>1.2455</td><td>2.025</td><td>1.618</td><td>-17.926</td><td>1.382</td><td>0</td><td>154.7</td><td>1.453</td><td>20.2146</td><td>0.0102</td><td>21.52</td><td>9.983</td><td>22.0192</td><td>0.5036</td><td>242.1</td><td>7.892</td><td>18.8020</td><td>0.0354</td><td>3.2172</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>45.05816745630</td><td>0.0379</td><td>0.12740379563</td><td>0.0382</td><td>3332894779520</td><td>1.7423</td><td>0.0493</td><td>6.399</td><td>0.076</td><td>-12.943</td><td>0.085</td><td>0</td><td>1.852e+05</td><td>41.01</td><td>12.5193</td><td>0.0002</td><td>8.092e+04</td><td>105</td><td>13.0813</td><td>0.0014</td><td>1.479e+05</td><td>211.9</td><td>11.8373</td><td>0.0016</td><td>1.2440</td><td>4.57</td><td>1.71</td><td>4795.41</td><td>--</td><td>--</td><td>2.42</td><td>2.799</td></tr>
<tr><td>45.03360726996</td><td>0.0378</td><td>0.12855408408</td><td>0.0309</td><td>3371550165888</td><td>1.7657</td><td>0.0430</td><td>-21.567</td><td>0.068</td><td>-38.885</td><td>0.065</td><td>0</td><td>2.79e+04</td><td>10.69</td><td>14.5742</td><td>0.0004</td><td>1.252e+04</td><td>20.19</td><td>15.1076</td><td>0.0018</td><td>2.229e+04</td><td>46.37</td><td>13.8915</td><td>0.0023</td><td>1.2161</td><td>--</td><td>--</td><td>4904.00</td><td>0.5367</td><td>0.2647</td><td>0.88</td><td>0.399</td></tr>
<tr><td>45.06731863358</td><td>2.1973</td><td>0.14490113553</td><td>1.2428</td><td>3435974261120</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>0</td><td>143</td><td>1.857</td><td>20.3004</td><td>0.0141</td><td>57.32</td><td>5.958</td><td>20.9557</td><td>0.1129</td><td>163.9</td><td>6.416</td><td>19.2254</td><td>0.0425</td><td>1.7303</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>45.07550476114</td><td>2.2580</td><td>0.15231639979</td><td>1.4745</td><td>3470333738112</td><td>0.8328</td><td>2.3109</td><td>-0.174</td><td>3.818</td><td>0.140</td><td>3.217</td><td>0</td><td>99.99</td><td>1.637</td><td>20.6885</td><td>0.0178</td><td>57.65</td><td>14.24</td><td>20.9493</td><td>0.2683</td><td>80.19</td><td>22.01</td><td>20.0016</td><td>0.2980</td><td>0.9478</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>45.05595245784</td><td>0.0366</td><td>0.14611160108</td><td>0.0362</td><td>3508989119232</td><td>1.0710</td><td>0.0467</td><td>9.666</td><td>0.075</td><td>3.016</td><td>0.079</td><td>0</td><td>1.607e+04</td><td>7.48</td><td>15.1734</td><td>0.0005</td><td>8030</td><td>28.04</td><td>15.5896</td><td>0.0038</td><td>1.18e+04</td><td>58.94</td><td>14.5820</td><td>0.0054</td><td>1.0076</td><td>--</td><td>--</td><td>5276.22</td><td>0.2440</td><td>0.1200</td><td>0.91</td><td>0.581</td></tr>
<tr><td>45.03182519785</td><td>0.3384</td><td>0.14417677582</td><td>0.2889</td><td>3607772690688</td><td>1.1949</td><td>0.3663</td><td>-0.624</td><td>0.715</td><td>-3.586</td><td>0.579</td><td>0</td><td>464.9</td><td>1.673</td><td>19.0200</td><td>0.0039</td><td>131.2</td><td>11.29</td><td>20.0569</td><td>0.0934</td><td>490.8</td><td>8.804</td><td>18.0347</td><td>0.0195</td><td>2.0222</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>45.01995117378</td><td>0.3859</td><td>0.16376890992</td><td>0.3726</td><td>3676493398016</td><td>1.7478</td><td>0.4291</td><td>24.344</td><td>0.874</td><td>-2.072</td><td>0.916</td><td>0</td><td>300.7</td><td>1.595</td><td>19.4932</td><td>0.0058</td><td>54.25</td><td>8.919</td><td>21.0154</td><td>0.1785</td><td>453.7</td><td>8.354</td><td>18.1200</td><td>0.0200</td><td>2.8954</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>45.01912041034</td><td>35.2696</td><td>0.16323908374</td><td>16.9303</td><td>3676492169728</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>1</td><td>181.7</td><td>4.293</td><td>20.0400</td><td>0.0257</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>45.06163798368</td><td>0.4328</td><td>0.17097451439</td><td>0.4597</td><td>3745211647360</td><td>-0.7117</td><td>0.7213</td><td>-0.324</td><td>0.825</td><td>-0.009</td><td>0.797</td><td>0</td><td>369</td><td>1.719</td><td>19.2709</td><td>0.0051</td><td>118.1</td><td>7.41</td><td>20.1712</td><td>0.0681</td><td>408.7</td><td>20.68</td><td>18.2335</td><td>0.0549</td><td>1.9377</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>45.02390681253</td><td>2.3998</td><td>0.16734769508</td><td>2.0558</td><td>3779572614144</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>0</td><td>67.67</td><td>1.372</td><td>21.1124</td><td>0.0220</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
</table></div></div></div>
</div>
<p>As you will see below, we only need coordinates, 2MASS photometry in the H and K band, and Gaia photometry in the Gaia G band. So we’ll query the tables <code class="docutils literal notranslate"><span class="pre">II/246/out</span></code> for 2MASS and <code class="docutils literal notranslate"><span class="pre">I/345/gaia2</span></code> for Gaia DR2:</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">twomass</span> <span class="o">=</span> <span class="n">moc_intersection</span><span class="o">.</span><span class="n">query_vizier_table</span><span class="p">(</span><span class="s2">&quot;II/246/out&quot;</span><span class="p">,</span> <span class="n">max_rows</span><span class="o">=</span><span class="mi">20000</span><span class="p">)</span>
<span class="n">twomass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table length=20000</i>
<table id="table139672429485168" class="table-striped table-bordered table-condensed">
<thead><tr><th>_2MASS</th><th>RAJ2000</th><th>DEJ2000</th><th>errHalfMaj</th><th>errHalfMin</th><th>errPosAng</th><th>Jmag</th><th>Hmag</th><th>Kmag</th><th>e_Jmag</th><th>e_Hmag</th><th>e_Kmag</th><th>Qfl</th><th>Rfl</th><th>X</th><th>MeasureJD</th></tr></thead>
<thead><tr><th></th><th>deg</th><th>deg</th><th>arcsec</th><th>arcsec</th><th>deg</th><th>mag</th><th>mag</th><th>mag</th><th>mag</th><th>mag</th><th>mag</th><th></th><th></th><th></th><th>d</th></tr></thead>
<thead><tr><th>str17</th><th>float64</th><th>float64</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>float32</th><th>str3</th><th>int16</th><th>uint8</th><th>float64</th></tr></thead>
<tr><td>06561231-2715514</td><td>104.051312</td><td>-27.264296</td><td>0.11</td><td>0.11</td><td>45.0</td><td>15.816</td><td>15.533</td><td>15.274</td><td>0.068</td><td>0.104</td><td>0.192</td><td>AAC</td><td>222</td><td>0</td><td>2451203.5942</td></tr>
<tr><td>06561317-2715210</td><td>104.05491</td><td>-27.255844</td><td>0.06</td><td>0.06</td><td>90.0</td><td>13.891</td><td>13.292</td><td>13.059</td><td>0.026</td><td>0.033</td><td>0.034</td><td>AAA</td><td>222</td><td>0</td><td>2451203.5942</td></tr>
<tr><td>06561481-2716053</td><td>104.061712</td><td>-27.268162</td><td>0.06</td><td>0.06</td><td>90.0</td><td>13.857</td><td>13.336</td><td>13.2</td><td>0.026</td><td>0.022</td><td>0.039</td><td>AAA</td><td>222</td><td>0</td><td>2451203.5942</td></tr>
<tr><td>06561479-2715417</td><td>104.061646</td><td>-27.261585</td><td>0.06</td><td>0.06</td><td>90.0</td><td>13.43</td><td>13.234</td><td>13.266</td><td>0.023</td><td>0.022</td><td>0.041</td><td>AAA</td><td>222</td><td>0</td><td>2451203.5942</td></tr>
<tr><td>06561641-2715166</td><td>104.068408</td><td>-27.254629</td><td>0.06</td><td>0.06</td><td>45.0</td><td>13.843</td><td>13.625</td><td>13.543</td><td>0.029</td><td>0.038</td><td>0.045</td><td>AAA</td><td>222</td><td>0</td><td>2451203.5942</td></tr>
<tr><td>06561656-2715126</td><td>104.069033</td><td>-27.253527</td><td>0.16</td><td>0.15</td><td>75.0</td><td>14.947</td><td>15.883</td><td>14.747</td><td>--</td><td>0.137</td><td>--</td><td>UBU</td><td>20</td><td>0</td><td>2451203.5942</td></tr>
<tr><td>06561660-2715246</td><td>104.069205</td><td>-27.256844</td><td>0.06</td><td>0.06</td><td>90.0</td><td>15.04</td><td>14.631</td><td>14.457</td><td>0.052</td><td>0.068</td><td>0.092</td><td>AAA</td><td>222</td><td>0</td><td>2451203.5942</td></tr>
<tr><td>06561532-2714537</td><td>104.063862</td><td>-27.248253</td><td>0.08</td><td>0.08</td><td>135.0</td><td>15.698</td><td>15.2</td><td>15.02</td><td>0.053</td><td>0.07</td><td>0.143</td><td>AAB</td><td>222</td><td>0</td><td>2451203.5942</td></tr>
<tr><td>06561543-2714325</td><td>104.064318</td><td>-27.242363</td><td>0.06</td><td>0.06</td><td>45.0</td><td>14.627</td><td>14.231</td><td>14.075</td><td>0.037</td><td>0.042</td><td>0.068</td><td>AAA</td><td>222</td><td>0</td><td>2451203.5942</td></tr>
<tr><td>06561711-2714541</td><td>104.071307</td><td>-27.248383</td><td>0.06</td><td>0.06</td><td>90.0</td><td>13.67</td><td>13.307</td><td>13.163</td><td>0.026</td><td>0.025</td><td>0.029</td><td>AAA</td><td>222</td><td>0</td><td>2451203.5942</td></tr>
<tr><td>06562032-2715025</td><td>104.084702</td><td>-27.250706</td><td>0.07</td><td>0.06</td><td>4.0</td><td>14.724</td><td>14.331</td><td>14.457</td><td>0.029</td><td>0.041</td><td>0.101</td><td>AAA</td><td>222</td><td>0</td><td>2451203.5942</td></tr>
<tr><td>06562075-2714021</td><td>104.086461</td><td>-27.233923</td><td>0.13</td><td>0.13</td><td>45.0</td><td>16.484</td><td>15.728</td><td>16.289</td><td>0.105</td><td>0.107</td><td>--</td><td>AAU</td><td>220</td><td>0</td><td>2451203.5942</td></tr>
<tr><td>06561726-2714384</td><td>104.071925</td><td>-27.244024</td><td>0.06</td><td>0.06</td><td>90.0</td><td>13.481</td><td>13.139</td><td>13.014</td><td>0.023</td><td>0.027</td><td>0.033</td><td>AAA</td><td>222</td><td>0</td><td>2451203.5942</td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>06564040-2601515</td><td>104.168335</td><td>-26.030979</td><td>0.21</td><td>0.18</td><td>82.0</td><td>16.176</td><td>15.644</td><td>15.08</td><td>0.124</td><td>0.179</td><td>0.168</td><td>BCC</td><td>222</td><td>0</td><td>2451296.4892</td></tr>
<tr><td>06564539-2601032</td><td>104.18915</td><td>-26.017569</td><td>0.28</td><td>0.27</td><td>176.0</td><td>16.247</td><td>15.531</td><td>15.52</td><td>0.114</td><td>0.161</td><td>0.247</td><td>BCD</td><td>222</td><td>0</td><td>2451296.4892</td></tr>
<tr><td>06564602-2600142</td><td>104.191783</td><td>-26.003965</td><td>0.07</td><td>0.07</td><td>45.0</td><td>15.012</td><td>14.615</td><td>14.541</td><td>0.052</td><td>0.072</td><td>0.103</td><td>AAA</td><td>222</td><td>0</td><td>2451296.4892</td></tr>
<tr><td>06564554-2600421</td><td>104.189787</td><td>-26.011698</td><td>0.06</td><td>0.06</td><td>45.0</td><td>14.968</td><td>14.482</td><td>14.039</td><td>0.048</td><td>0.058</td><td>0.074</td><td>AAA</td><td>222</td><td>0</td><td>2451296.4892</td></tr>
<tr><td>06564981-2600284</td><td>104.207569</td><td>-26.007895</td><td>0.08</td><td>0.08</td><td>45.0</td><td>15.828</td><td>15.263</td><td>14.8</td><td>0.083</td><td>0.133</td><td>0.143</td><td>ABB</td><td>222</td><td>0</td><td>2451296.4892</td></tr>
<tr><td>06564783-2600242</td><td>104.199297</td><td>-26.006746</td><td>0.12</td><td>0.11</td><td>10.0</td><td>15.928</td><td>15.543</td><td>15.242</td><td>0.098</td><td>0.149</td><td>0.184</td><td>ACC</td><td>222</td><td>0</td><td>2451296.4892</td></tr>
<tr><td>06564644-2600212</td><td>104.193517</td><td>-26.005903</td><td>0.07</td><td>0.06</td><td>90.0</td><td>15.132</td><td>14.395</td><td>14.224</td><td>0.056</td><td>0.074</td><td>0.084</td><td>AAA</td><td>222</td><td>0</td><td>2451296.4892</td></tr>
<tr><td>06564711-2559578</td><td>104.196329</td><td>-25.999401</td><td>0.28</td><td>0.26</td><td>81.0</td><td>16.152</td><td>15.523</td><td>15.484</td><td>0.108</td><td>0.147</td><td>0.255</td><td>BCD</td><td>222</td><td>0</td><td>2451296.4892</td></tr>
<tr><td>06564864-2559555</td><td>104.202699</td><td>-25.99877</td><td>0.17</td><td>0.16</td><td>41.0</td><td>16.357</td><td>16.136</td><td>16.915</td><td>0.133</td><td>--</td><td>--</td><td>BUU</td><td>200</td><td>0</td><td>2451296.4892</td></tr>
<tr><td>06564676-2559428</td><td>104.19487</td><td>-25.995239</td><td>0.07</td><td>0.06</td><td>0.0</td><td>13.579</td><td>13.198</td><td>13.132</td><td>0.032</td><td>0.031</td><td>0.034</td><td>AAA</td><td>222</td><td>0</td><td>2451296.4892</td></tr>
<tr><td>06564535-2559589</td><td>104.188986</td><td>-25.999701</td><td>0.09</td><td>0.09</td><td>0.0</td><td>15.802</td><td>15.266</td><td>15.144</td><td>0.082</td><td>0.127</td><td>0.174</td><td>ABC</td><td>222</td><td>0</td><td>2451296.4892</td></tr>
<tr><td>06565753-2601231</td><td>104.239722</td><td>-26.023087</td><td>0.06</td><td>0.06</td><td>45.0</td><td>13.026</td><td>12.932</td><td>12.944</td><td>0.026</td><td>0.029</td><td>0.033</td><td>AAA</td><td>222</td><td>0</td><td>2451296.4892</td></tr>
<tr><td>06565979-2601016</td><td>104.249134</td><td>-26.017115</td><td>0.17</td><td>0.16</td><td>135.0</td><td>16.589</td><td>15.934</td><td>16.926</td><td>0.137</td><td>0.143</td><td>--</td><td>BBU</td><td>220</td><td>0</td><td>2451208.533</td></tr>
</table></div></div></div>
</div>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gaia</span> <span class="o">=</span> <span class="n">moc_intersection</span><span class="o">.</span><span class="n">query_vizier_table</span><span class="p">(</span><span class="s2">&quot;I/345/gaia2&quot;</span><span class="p">,</span> <span class="n">max_rows</span><span class="o">=</span><span class="mi">20000</span><span class="p">)</span>
<span class="n">gaia</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table length=20000</i>
<table id="table139672358261712" class="table-striped table-bordered table-condensed">
<thead><tr><th>ra_epoch2000</th><th>dec_epoch2000</th><th>errHalfMaj</th><th>errHalfMin</th><th>errPosAng</th><th>source_id</th><th>ra</th><th>ra_error</th><th>dec</th><th>dec_error</th><th>parallax</th><th>parallax_error</th><th>pmra</th><th>pmra_error</th><th>pmdec</th><th>pmdec_error</th><th>duplicated_source</th><th>phot_g_mean_flux</th><th>phot_g_mean_flux_error</th><th>phot_g_mean_mag</th><th>phot_bp_mean_flux</th><th>phot_bp_mean_flux_error</th><th>phot_bp_mean_mag</th><th>phot_rp_mean_flux</th><th>phot_rp_mean_flux_error</th><th>phot_rp_mean_mag</th><th>bp_rp</th><th>radial_velocity</th><th>radial_velocity_error</th><th>rv_nb_transits</th><th>teff_val</th><th>a_g_val</th><th>e_bp_min_rp_val</th><th>radius_val</th><th>lum_val</th></tr></thead>
<thead><tr><th>deg</th><th>deg</th><th>arcsec</th><th>arcsec</th><th>deg</th><th></th><th>deg</th><th>mas</th><th>deg</th><th>mas</th><th>mas</th><th>mas</th><th>mas / yr</th><th>mas / yr</th><th>mas / yr</th><th>mas / yr</th><th></th><th>e-/s</th><th>e-/s</th><th>mag</th><th>e-/s</th><th>e-/s</th><th>mag</th><th>e-/s</th><th>e-/s</th><th>mag</th><th>mag</th><th>km / s</th><th>km / s</th><th></th><th>K</th><th>mag</th><th>mag</th><th>Rsun</th><th>Lsun</th></tr></thead>
<thead><tr><th>float64</th><th>float64</th><th>float32</th><th>float32</th><th>float32</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>bool</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>int16</th><th>float64</th><th>float32</th><th>float32</th><th>float64</th><th>float64</th></tr></thead>
<tr><td>104.0642397349738</td><td>-27.2482245363508</td><td>0.009</td><td>0.002</td><td>0.0</td><td>2920584465727934848</td><td>104.06423973497</td><td>2.314</td><td>-27.24822453635</td><td>8.5789</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>False</td><td>80.4691</td><td>1.21343</td><td>20.924294</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td><td>0</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>104.0613350962615</td><td>-27.2457120515062</td><td>0.02</td><td>0.017</td><td>0.0</td><td>2920584465727934720</td><td>104.06133865504</td><td>0.4795</td><td>-27.24572610529</td><td>0.7266</td><td>2.7925</td><td>0.9319</td><td>0.735</td><td>1.066</td><td>-3.264</td><td>1.314</td><td>False</td><td>110.232</td><td>0.811783</td><td>20.582594</td><td>29.761</td><td>6.19097</td><td>21.667269</td><td>127.117</td><td>5.50348</td><td>19.50141</td><td>2.165859</td><td>--</td><td>--</td><td>0</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>104.0616994142013</td><td>-27.268162501078</td><td>0.001</td><td>0.001</td><td>0.0</td><td>2920584362651704192</td><td>104.06176472191</td><td>0.0195</td><td>-27.26826983064</td><td>0.0282</td><td>1.5899</td><td>0.0331</td><td>13.483</td><td>0.044</td><td>-24.928</td><td>0.058</td><td>False</td><td>12121.4</td><td>4.76419</td><td>15.479486</td><td>5099.4</td><td>12.5228</td><td>16.08259</td><td>10058.7</td><td>14.8426</td><td>14.755564</td><td>1.327026</td><td>--</td><td>--</td><td>0</td><td>4984.0</td><td>0.309</td><td>0.1495</td><td>0.61</td><td>0.21</td></tr>
<tr><td>104.0638238272635</td><td>-27.2482586806547</td><td>0.002</td><td>0.002</td><td>0.0</td><td>2920584461429778816</td><td>104.06382329382</td><td>0.0521</td><td>-27.24823315928</td><td>0.0765</td><td>0.6544</td><td>0.0872</td><td>-0.11</td><td>0.121</td><td>5.928</td><td>0.159</td><td>False</td><td>2056.52</td><td>1.79544</td><td>17.405537</td><td>875.686</td><td>6.96038</td><td>17.995518</td><td>1741.36</td><td>7.67767</td><td>16.659698</td><td>1.335819</td><td>--</td><td>--</td><td>0</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>104.0534300495002</td><td>-27.2500426156094</td><td>0.014</td><td>0.011</td><td>0.0</td><td>2920584427070040064</td><td>104.05342677462</td><td>0.3271</td><td>-27.25003658704</td><td>0.5302</td><td>0.8947</td><td>0.6557</td><td>-0.676</td><td>0.732</td><td>1.4</td><td>0.92</td><td>False</td><td>162.774</td><td>0.812274</td><td>20.159405</td><td>93.9469</td><td>11.4891</td><td>20.419182</td><td>132.283</td><td>6.62032</td><td>19.458162</td><td>0.96102</td><td>--</td><td>--</td><td>0</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>104.0751267092824</td><td>-27.2497140040521</td><td>0.007</td><td>0.006</td><td>0.0</td><td>2920584392710301952</td><td>104.07512382264</td><td>0.1708</td><td>-27.24969690641</td><td>0.2387</td><td>-0.2191</td><td>0.2883</td><td>-0.596</td><td>0.38</td><td>3.971</td><td>0.463</td><td>False</td><td>354.083</td><td>0.968096</td><td>19.315603</td><td>194.984</td><td>4.1286</td><td>19.626392</td><td>251.52</td><td>5.09448</td><td>18.760487</td><td>0.865906</td><td>--</td><td>--</td><td>0</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>104.0742449208677</td><td>-27.2644027644464</td><td>0.009</td><td>0.008</td><td>0.0</td><td>2920584392710299648</td><td>104.07423733605</td><td>0.2424</td><td>-27.26439208515</td><td>0.3022</td><td>0.1011</td><td>0.3706</td><td>-1.566</td><td>0.531</td><td>2.48</td><td>0.558</td><td>False</td><td>249.17</td><td>0.921325</td><td>19.697124</td><td>112.126</td><td>4.99648</td><td>20.227123</td><td>190.76</td><td>5.88838</td><td>19.060701</td><td>1.166422</td><td>--</td><td>--</td><td>0</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>104.0773944731844</td><td>-27.2633504544413</td><td>0.008</td><td>0.007</td><td>0.0</td><td>2920584392710299520</td><td>104.07739347867</td><td>0.2151</td><td>-27.26333600118</td><td>0.2962</td><td>-0.3964</td><td>0.3634</td><td>-0.205</td><td>0.474</td><td>3.357</td><td>0.546</td><td>False</td><td>270.933</td><td>0.898977</td><td>19.60621</td><td>116.801</td><td>5.97621</td><td>20.18277</td><td>216.387</td><td>5.2083</td><td>18.923845</td><td>1.258925</td><td>--</td><td>--</td><td>0</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>104.0570207631639</td><td>-27.2646632110967</td><td>0.012</td><td>0.01</td><td>0.0</td><td>2920584358350560512</td><td>104.05701812772</td><td>0.2794</td><td>-27.26464198072</td><td>0.3739</td><td>0.1062</td><td>0.4371</td><td>-0.544</td><td>0.629</td><td>4.931</td><td>0.787</td><td>False</td><td>224.061</td><td>0.805978</td><td>19.81245</td><td>88.3315</td><td>4.79911</td><td>20.4861</td><td>185.474</td><td>5.74906</td><td>19.091215</td><td>1.394884</td><td>--</td><td>--</td><td>0</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>104.067647998646</td><td>-27.2654819544346</td><td>0.011</td><td>0.009</td><td>0.0</td><td>2920584358350560384</td><td>104.0676432926</td><td>0.2658</td><td>-27.26547922509</td><td>0.3692</td><td>-0.6521</td><td>0.4458</td><td>-0.972</td><td>0.591</td><td>0.634</td><td>0.712</td><td>False</td><td>197.516</td><td>0.774971</td><td>19.949358</td><td>89.6643</td><td>6.05208</td><td>20.46984</td><td>147.016</td><td>4.92361</td><td>19.343506</td><td>1.126333</td><td>--</td><td>--</td><td>0</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>104.0625613443571</td><td>-27.2779499139245</td><td>0.005</td><td>0.004</td><td>0.0</td><td>2920584358350560128</td><td>104.0625464304</td><td>0.1315</td><td>-27.27793684683</td><td>0.1714</td><td>0.5521</td><td>0.2058</td><td>-3.079</td><td>0.286</td><td>3.035</td><td>0.329</td><td>False</td><td>570.942</td><td>1.29964</td><td>18.796886</td><td>282.403</td><td>4.74613</td><td>19.224215</td><td>415.634</td><td>5.65279</td><td>18.215143</td><td>1.009071</td><td>--</td><td>--</td><td>0</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>104.0524334477795</td><td>-27.2528825507896</td><td>0.016</td><td>0.013</td><td>0.0</td><td>2920584431371234688</td><td>104.05243706112</td><td>0.3667</td><td>-27.25286659556</td><td>0.6065</td><td>0.7646</td><td>0.7255</td><td>0.746</td><td>0.833</td><td>3.706</td><td>1.035</td><td>False</td><td>148.767</td><td>0.914238</td><td>20.257097</td><td>46.5355</td><td>6.28794</td><td>21.181927</td><td>179.523</td><td>5.8407</td><td>19.126621</td><td>2.055306</td><td>--</td><td>--</td><td>0</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>104.0517864137349</td><td>-27.2664989328045</td><td>0.004</td><td>0.003</td><td>0.0</td><td>2920584431368206208</td><td>104.05178695732</td><td>0.0912</td><td>-27.26648745784</td><td>0.1318</td><td>0.1051</td><td>0.1589</td><td>0.112</td><td>0.212</td><td>2.665</td><td>0.267</td><td>False</td><td>924.077</td><td>1.32833</td><td>18.274096</td><td>496.688</td><td>5.43714</td><td>18.611177</td><td>629.128</td><td>6.64563</td><td>17.765072</td><td>0.846106</td><td>--</td><td>--</td><td>0</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>103.6842737979447</td><td>-26.7017503328947</td><td>0.037</td><td>0.034</td><td>90.0</td><td>2920662565413339904</td><td>103.68428008329</td><td>1.2459</td><td>-26.70174992807</td><td>1.3821</td><td>-2.2439</td><td>1.7372</td><td>1.304</td><td>2.365</td><td>0.094</td><td>2.175</td><td>False</td><td>79.5694</td><td>0.728902</td><td>20.9365</td><td>46.5208</td><td>9.30062</td><td>21.182272</td><td>69.2421</td><td>9.30353</td><td>20.160994</td><td>1.021278</td><td>--</td><td>--</td><td>0</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>103.6820034780249</td><td>-26.6937761144216</td><td>0.022</td><td>0.021</td><td>0.0</td><td>2920662634130817280</td><td>103.68199815747</td><td>0.6459</td><td>-26.69380694957</td><td>0.7993</td><td>-0.8871</td><td>1.0528</td><td>-1.104</td><td>1.328</td><td>-7.162</td><td>1.417</td><td>False</td><td>102.542</td><td>0.905935</td><td>20.661116</td><td>33.4179</td><td>3.92701</td><td>21.541441</td><td>129.802</td><td>6.87251</td><td>19.478714</td><td>2.062727</td><td>--</td><td>--</td><td>0</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>103.7023633842059</td><td>-26.693778177254</td><td>0.01</td><td>0.008</td><td>0.0</td><td>2920662595476109056</td><td>103.70236259794</td><td>0.2279</td><td>-26.69377767625</td><td>0.3259</td><td>0.7025</td><td>0.4055</td><td>-0.163</td><td>0.504</td><td>0.116</td><td>0.646</td><td>False</td><td>239.363</td><td>0.951384</td><td>19.740725</td><td>130.015</td><td>7.9778</td><td>20.066406</td><td>185.254</td><td>6.96004</td><td>19.0925</td><td>0.973906</td><td>--</td><td>--</td><td>0</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>103.67736401159</td><td>-26.6877543256818</td><td>0.017</td><td>0.014</td><td>0.0</td><td>2920662634130810880</td><td>103.67736098157</td><td>0.3959</td><td>-26.68773232011</td><td>0.5748</td><td>1.2492</td><td>0.7108</td><td>-0.629</td><td>0.914</td><td>5.111</td><td>1.077</td><td>False</td><td>128.438</td><td>0.720352</td><td>20.416636</td><td>50.119</td><td>8.06151</td><td>21.101381</td><td>155.45</td><td>5.97567</td><td>19.282942</td><td>1.81844</td><td>--</td><td>--</td><td>0</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>103.6534419859618</td><td>-26.6979173546072</td><td>0.011</td><td>0.008</td><td>0.0</td><td>2920662732915053568</td><td>103.65344412303</td><td>0.2405</td><td>-26.6979121828</td><td>0.3592</td><td>-0.2447</td><td>0.4337</td><td>0.443</td><td>0.527</td><td>1.201</td><td>0.703</td><td>False</td><td>243.033</td><td>0.82508</td><td>19.724205</td><td>122.136</td><td>6.61412</td><td>20.134275</td><td>190.878</td><td>5.0736</td><td>19.060034</td><td>1.074242</td><td>--</td><td>--</td><td>0</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>103.6448602407325</td><td>-26.6802759107745</td><td>0.02</td><td>0.016</td><td>0.0</td><td>2920662805934420608</td><td>103.64483841775</td><td>0.4784</td><td>-26.68027019884</td><td>0.7468</td><td>-0.416</td><td>0.9312</td><td>-4.529</td><td>1.041</td><td>1.327</td><td>1.287</td><td>False</td><td>111.582</td><td>0.895516</td><td>20.569384</td><td>57.4815</td><td>6.8582</td><td>20.952568</td><td>95.2456</td><td>4.81755</td><td>19.814808</td><td>1.13776</td><td>--</td><td>--</td><td>0</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>103.6457054696464</td><td>-26.6981699399863</td><td>0.001</td><td>0.001</td><td>0.0</td><td>2920662698555162368</td><td>103.64568696319</td><td>0.0173</td><td>-26.69816199835</td><td>0.0245</td><td>1.9823</td><td>0.0283</td><td>-3.84</td><td>0.038</td><td>1.845</td><td>0.054</td><td>False</td><td>245087.0</td><td>31.1344</td><td>12.215064</td><td>130678.0</td><td>131.721</td><td>12.560881</td><td>163903.0</td><td>73.7421</td><td>11.725456</td><td>0.835424</td><td>71.72</td><td>1.12</td><td>13</td><td>5776.33</td><td>0.846</td><td>0.4065</td><td>1.57</td><td>2.463</td></tr>
<tr><td>103.6371030479543</td><td>-26.7044315808754</td><td>0.005</td><td>0.004</td><td>0.0</td><td>2920662698555289472</td><td>103.6370976891</td><td>0.1128</td><td>-26.70442672734</td><td>0.1577</td><td>0.0761</td><td>0.1887</td><td>-1.112</td><td>0.244</td><td>1.127</td><td>0.321</td><td>False</td><td>618.666</td><td>1.19579</td><td>18.709726</td><td>310.82</td><td>7.22852</td><td>19.120115</td><td>450.3</td><td>5.5849</td><td>18.128166</td><td>0.991949</td><td>--</td><td>--</td><td>0</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>103.6456888116766</td><td>-26.693409125209</td><td>0.012</td><td>0.01</td><td>0.0</td><td>2920662737210100992</td><td>103.64568864196</td><td>0.3058</td><td>-26.69339933944</td><td>0.4287</td><td>0.3929</td><td>0.5375</td><td>-0.035</td><td>0.676</td><td>2.273</td><td>0.788</td><td>False</td><td>182.539</td><td>0.828202</td><td>20.034979</td><td>92.8826</td><td>5.12254</td><td>20.431551</td><td>160.285</td><td>5.1688</td><td>19.24969</td><td>1.181862</td><td>--</td><td>--</td><td>0</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>103.6501059275592</td><td>-26.6996148606457</td><td>0.01</td><td>0.007</td><td>0.0</td><td>2920662698555304576</td><td>103.65009776268</td><td>0.2151</td><td>-26.69960283806</td><td>0.326</td><td>0.4273</td><td>0.394</td><td>-1.694</td><td>0.472</td><td>2.792</td><td>0.621</td><td>False</td><td>249.158</td><td>0.843633</td><td>19.697176</td><td>130.477</td><td>8.06077</td><td>20.062551</td><td>218.437</td><td>7.50649</td><td>18.913603</td><td>1.148949</td><td>--</td><td>--</td><td>0</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>103.6595666536828</td><td>-26.6973161276413</td><td>0.019</td><td>0.016</td><td>0.0</td><td>2920662737210084608</td><td>103.65954407734</td><td>0.4646</td><td>-26.6972921808</td><td>0.7137</td><td>1.0984</td><td>0.8643</td><td>-4.685</td><td>1.01</td><td>5.562</td><td>1.241</td><td>False</td><td>123.589</td><td>0.804161</td><td>20.458414</td><td>42.8328</td><td>5.53901</td><td>21.271946</td><td>143.462</td><td>6.25761</td><td>19.37008</td><td>1.901865</td><td>--</td><td>--</td><td>0</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>103.6457432485343</td><td>-26.7008849970763</td><td>0.018</td><td>0.013</td><td>0.0</td><td>2920662702850376192</td><td>103.64573874872</td><td>0.3872</td><td>-26.70086725867</td><td>0.5581</td><td>-1.2408</td><td>0.6952</td><td>-0.934</td><td>0.858</td><td>4.12</td><td>1.153</td><td>False</td><td>122.459</td><td>0.708617</td><td>20.468393</td><td>77.6656</td><td>8.66697</td><td>20.625816</td><td>151.422</td><td>7.91143</td><td>19.31145</td><td>1.314367</td><td>--</td><td>--</td><td>0</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>103.6428952792929</td><td>-26.6997584901798</td><td>0.029</td><td>0.021</td><td>0.0</td><td>2920662702850377344</td><td>103.64289510825</td><td>0.6431</td><td>-26.69974515128</td><td>1.0558</td><td>0.884</td><td>1.2836</td><td>-0.035</td><td>1.386</td><td>3.098</td><td>1.845</td><td>False</td><td>85.1474</td><td>0.864897</td><td>20.862938</td><td>65.0185</td><td>7.27796</td><td>20.818796</td><td>100.969</td><td>8.51741</td><td>19.751446</td><td>1.06735</td><td>--</td><td>--</td><td>0</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
</table></div></div></div>
</div>
</section>
<section id="step-6-cross-match-gaia-and-2mass-sources-in-all-fields">
<h2>Step 6: Cross-match Gaia and 2MASS sources in all fields<a class="headerlink" href="#step-6-cross-match-gaia-and-2mass-sources-in-all-fields" title="Link to this heading">#</a></h2>
<p>We now want to find sources in the selected region (observed in the MASH regions of interest and at low extinction) that are common to the 2MASS and Gaia catalogs. To do so, we will perform a cross-match of the Gaia and 2MASS catalogs. Alternatively, we could use the CDS XMatch service via the corresponding <code class="docutils literal notranslate"><span class="pre">astroquery</span></code> module.</p>
<p>To do so, let’s first inspect the <code class="docutils literal notranslate"><span class="pre">match_coordinates_sky</span></code> function from <code class="docutils literal notranslate"><span class="pre">astropy.coordinates</span></code>.</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">match_coordinates_sky</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function match_coordinates_sky in module astropy.coordinates.matching:

match_coordinates_sky(matchcoord, catalogcoord, nthneighbor=1, storekdtree=&#39;kdtree_sky&#39;)
    Finds the nearest on-sky matches of a coordinate or coordinates in
    a set of catalog coordinates.
    
    This finds the on-sky closest neighbor, which is only different from the
    3-dimensional match if ``distance`` is set in either ``matchcoord``
    or ``catalogcoord``.
    
    Parameters
    ----------
    matchcoord : `~astropy.coordinates.BaseCoordinateFrame` or `~astropy.coordinates.SkyCoord`
        The coordinate(s) to match to the catalog.
    catalogcoord : `~astropy.coordinates.BaseCoordinateFrame` or `~astropy.coordinates.SkyCoord`
        The base catalog in which to search for matches. Typically this will
        be a coordinate object that is an array (i.e.,
        ``catalogcoord.isscalar == False``)
    nthneighbor : int, optional
        Which closest neighbor to search for.  Typically ``1`` is desired here,
        as that is correct for matching one set of coordinates to another.
        The next likely use case is ``2``, for matching a coordinate catalog
        against *itself* (``1`` is inappropriate because each point will find
        itself as the closest match).
    storekdtree : bool or str, optional
        If a string, will store the KD-Tree used for the computation
        in the ``catalogcoord`` in ``catalogcoord.cache`` with the
        provided name.  This dramatically speeds up subsequent calls with the
        same catalog. If False, the KD-Tree is discarded after use.
    
    Returns
    -------
    idx : int array
        Indices into ``catalogcoord`` to get the matched points for each
        ``matchcoord``. Shape matches ``matchcoord``.
    sep2d : `~astropy.coordinates.Angle`
        The on-sky separation between the closest match for each
        ``matchcoord`` and the ``matchcoord``. Shape matches ``matchcoord``.
    dist3d : `~astropy.units.Quantity` [&#39;length&#39;]
        The 3D distance between the closest match for each ``matchcoord`` and
        the ``matchcoord``. Shape matches ``matchcoord``.  If either
        ``matchcoord`` or ``catalogcoord`` don&#39;t have a distance, this is the 3D
        distance on the unit sphere, rather than a true distance.
    
    Notes
    -----
    This function requires `SciPy &lt;https://www.scipy.org/&gt;`_ to be installed
    or it will fail.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We generate the coordinates in the appropriate format</span>
<span class="n">twomass_coord</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="n">twomass</span><span class="p">[</span><span class="s2">&quot;RAJ2000&quot;</span><span class="p">],</span> <span class="n">dec</span><span class="o">=</span><span class="n">twomass</span><span class="p">[</span><span class="s2">&quot;DEJ2000&quot;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span>
<span class="n">gaia_coord</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="n">gaia</span><span class="p">[</span><span class="s2">&quot;ra_epoch2000&quot;</span><span class="p">],</span> <span class="n">dec</span><span class="o">=</span><span class="n">gaia</span><span class="p">[</span><span class="s2">&quot;dec_epoch2000&quot;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span>

<span class="n">index</span><span class="p">,</span> <span class="n">separation_2d</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">match_coordinates_sky</span><span class="p">(</span><span class="n">twomass_coord</span><span class="p">,</span> <span class="n">gaia_coord</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Decide the maximum separation between objects to be considered acceptable matches</span>
<span class="n">max_separation</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">arcsec</span>
<span class="c1"># Apply constraint on the two catalogs</span>
<span class="n">sep_constraint</span> <span class="o">=</span> <span class="n">separation_2d</span> <span class="o">&lt;</span> <span class="n">max_separation</span>
<span class="n">twomass_matches</span> <span class="o">=</span> <span class="n">twomass</span><span class="p">[</span><span class="n">sep_constraint</span><span class="p">]</span>
<span class="n">gaia_matches</span> <span class="o">=</span> <span class="n">gaia</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="n">sep_constraint</span><span class="p">]]</span>
<span class="c1"># Select only interesting columns from twomass_matches</span>
<span class="n">match_catalog</span> <span class="o">=</span> <span class="n">twomass_matches</span><span class="p">[</span><span class="s2">&quot;_2MASS&quot;</span><span class="p">,</span> <span class="s2">&quot;RAJ2000&quot;</span><span class="p">,</span> <span class="s2">&quot;DEJ2000&quot;</span><span class="p">,</span> <span class="s2">&quot;Hmag&quot;</span><span class="p">,</span> <span class="s2">&quot;Kmag&quot;</span><span class="p">]</span>
<span class="c1"># Add column G magnitude from gaia</span>
<span class="n">match_catalog</span><span class="p">[</span><span class="s2">&quot;Gmag&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gaia_matches</span><span class="p">[</span><span class="s2">&quot;phot_g_mean_mag&quot;</span><span class="p">]</span>
<span class="n">match_catalog</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table length=6376</i>
<table id="table139672355196640" class="table-striped table-bordered table-condensed">
<thead><tr><th>_2MASS</th><th>RAJ2000</th><th>DEJ2000</th><th>Hmag</th><th>Kmag</th><th>Gmag</th></tr></thead>
<thead><tr><th></th><th>deg</th><th>deg</th><th>mag</th><th>mag</th><th>mag</th></tr></thead>
<thead><tr><th>str17</th><th>float64</th><th>float64</th><th>float32</th><th>float32</th><th>float64</th></tr></thead>
<tr><td>06561231-2715514</td><td>104.051312</td><td>-27.264296</td><td>15.533</td><td>15.274</td><td>16.924894</td></tr>
<tr><td>06561317-2715210</td><td>104.05491</td><td>-27.255844</td><td>13.292</td><td>13.059</td><td>16.701544</td></tr>
<tr><td>06561481-2716053</td><td>104.061712</td><td>-27.268162</td><td>13.336</td><td>13.2</td><td>15.479486</td></tr>
<tr><td>06561479-2715417</td><td>104.061646</td><td>-27.261585</td><td>13.234</td><td>13.266</td><td>14.229291</td></tr>
<tr><td>06561641-2715166</td><td>104.068408</td><td>-27.254629</td><td>13.625</td><td>13.543</td><td>14.883485</td></tr>
<tr><td>06561656-2715126</td><td>104.069033</td><td>-27.253527</td><td>15.883</td><td>14.747</td><td>18.727604</td></tr>
<tr><td>06561660-2715246</td><td>104.069205</td><td>-27.256844</td><td>14.631</td><td>14.457</td><td>16.435612</td></tr>
<tr><td>06561532-2714537</td><td>104.063862</td><td>-27.248253</td><td>15.2</td><td>15.02</td><td>17.405537</td></tr>
<tr><td>06561543-2714325</td><td>104.064318</td><td>-27.242363</td><td>14.231</td><td>14.075</td><td>15.734059</td></tr>
<tr><td>06561711-2714541</td><td>104.071307</td><td>-27.248383</td><td>13.307</td><td>13.163</td><td>15.021435</td></tr>
<tr><td>06562032-2715025</td><td>104.084702</td><td>-27.250706</td><td>14.331</td><td>14.457</td><td>15.809618</td></tr>
<tr><td>06562075-2714021</td><td>104.086461</td><td>-27.233923</td><td>15.728</td><td>16.289</td><td>17.67484</td></tr>
<tr><td>06561726-2714384</td><td>104.071925</td><td>-27.244024</td><td>13.139</td><td>13.014</td><td>14.705641</td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>06544298-2641266</td><td>103.67909</td><td>-26.690739</td><td>11.837</td><td>11.801</td><td>13.017016</td></tr>
<tr><td>06544364-2641518</td><td>103.681834</td><td>-26.697739</td><td>15.817</td><td>15.608</td><td>16.517591</td></tr>
<tr><td>06544444-2641560</td><td>103.685202</td><td>-26.698898</td><td>15.801</td><td>15.703</td><td>17.983042</td></tr>
<tr><td>06544200-2641381</td><td>103.675002</td><td>-26.693939</td><td>12.981</td><td>12.961</td><td>14.510725</td></tr>
<tr><td>06544465-2641304</td><td>103.686061</td><td>-26.69179</td><td>13.983</td><td>13.896</td><td>15.409149</td></tr>
<tr><td>06544074-2641426</td><td>103.669757</td><td>-26.695183</td><td>14.713</td><td>14.588</td><td>16.237791</td></tr>
<tr><td>06544573-2642324</td><td>103.690544</td><td>-26.709017</td><td>13.162</td><td>13.106</td><td>14.364839</td></tr>
<tr><td>06545001-2641286</td><td>103.708399</td><td>-26.691288</td><td>14.669</td><td>14.662</td><td>16.041847</td></tr>
<tr><td>06544577-2641391</td><td>103.690725</td><td>-26.694202</td><td>14.811</td><td>14.78</td><td>16.717669</td></tr>
<tr><td>06544623-2640367</td><td>103.692647</td><td>-26.676868</td><td>15.171</td><td>14.327</td><td>18.58356</td></tr>
<tr><td>06543496-2641534</td><td>103.645686</td><td>-26.698172</td><td>10.895</td><td>10.8</td><td>12.215064</td></tr>
<tr><td>06560422-2639092</td><td>104.017586</td><td>-26.652565</td><td>16.295</td><td>15.76</td><td>19.62056</td></tr>
<tr><td>06585741-2635059</td><td>104.739224</td><td>-26.584993</td><td>15.503</td><td>15.558</td><td>18.368963</td></tr>
</table></div></div></div>
</div>
</section>
<section id="step-7-build-a-color-color-diagram">
<h2>Step 7: Build a color-color diagram<a class="headerlink" href="#step-7-build-a-color-color-diagram" title="Link to this heading">#</a></h2>
<p>We now use the data we got from the cross-match to get a 2MASS/Gaia color-color diagram for all the sources in the low extinction sky regions covered by the MASH survey:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">match_catalog</span><span class="p">[</span><span class="s2">&quot;Hmag&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">match_catalog</span><span class="p">[</span><span class="s2">&quot;Kmag&quot;</span><span class="p">],</span>
    <span class="n">match_catalog</span><span class="p">[</span><span class="s2">&quot;Gmag&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">match_catalog</span><span class="p">[</span><span class="s2">&quot;Hmag&quot;</span><span class="p">],</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;H - Ks [mag]&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;G - H [mag]&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0b6f49e260fb0e3005fc4410945d84b49e118d80d260cc27a0b6cf437ed6b9b8.png" src="_images/0b6f49e260fb0e3005fc4410945d84b49e118d80d260cc27a0b6cf437ed6b9b8.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "cds-astro/tutorials",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="5_Brown_Dwarf_Search__Cross-matching_Catalogs.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Discovery of brown dwarfs mining the 2MASS and SDSS databases</p>
      </div>
    </a>
    <a class="right-next"
       href="7_Multi-messenger_astronomy__Planning_observations_rapidly_with_MOCs.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Multi Order Coverage data structure to plan multi-messenger observations</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-finding-the-images">Step 1: Finding the images</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-create-a-moc-of-the-mash-images">Step 2: Create a MOC of the MASH images</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#organising-data">Organising data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-the-moc">Create the MOC</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-moc">Plot the MOC</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-load-an-archival-extinction-map-and-create-the-moc-of-the-low-extinction-regions">Step 3: Load an archival extinction map and create the MOC of the low extinction regions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-find-out-which-regions-are-covered-by-the-mash-short-red-images-in-the-low-extinction-regions-defined-above">Step 4:  Find out which regions are covered by the MASH short-red images in the low extinction regions defined above</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-query-the-2mass-and-gaia-catalogues-by-moc">Step 5: Query the 2MASS and Gaia Catalogues by MOC</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-6-cross-match-gaia-and-2mass-sources-in-all-fields">Step 6: Cross-match Gaia and 2MASS sources in all fields</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-7-build-a-color-color-diagram">Step 7: Build a color-color diagram</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Strasbourg astronomical Data Center (CDS)
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  This work has a BSD-3 clause license and has been supported by the ESCAPE project (the European Science Cluster of Astronomy & Particle Physics), funded from the European Union’s Horizon 2020 research and innovation program under grant agreement n°824064, the EOSC Future project co-funded by the European Union Horizon Program call INFRAEOSC-03-2020 - grant agreement n°101017536, and the project ASTERICS supported by the European Commission Framework Programme Horizon 2020 Research and Innovation action under grant agreement n°653477.
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>